# ğŸ¦ ì™„ì „í•œ í—¤ì§€í€ë“œê¸‰ Phoenix 95 ì•„í‚¤í…ì²˜

## ğŸ“‹ ëª©ì°¨
1. [ì‹œìŠ¤í…œ ê°œìš”](#-ì‹œìŠ¤í…œ-ê°œìš”)
2. [ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨](#-ì•„í‚¤í…ì²˜-ë‹¤ì´ì–´ê·¸ë¨)
3. [í•µì‹¬ 4ê°œ ì„œë¹„ìŠ¤](#-í•µì‹¬-4ê°œ-ì„œë¹„ìŠ¤)
4. [ì™„ì „í•œ êµ¬í˜„ ì½”ë“œ](#-ì™„ì „í•œ-êµ¬í˜„-ì½”ë“œ)
5. [Docker ë°°í¬ ì„¤ì •](#-docker-ë°°í¬-ì„¤ì •)
6. [ì„¤ì¹˜ ë° ì‹¤í–‰ ê°€ì´ë“œ](#-ì„¤ì¹˜-ë°-ì‹¤í–‰-ê°€ì´ë“œ)
7. [í…ŒìŠ¤íŠ¸ ë° ê²€ì¦](#-í…ŒìŠ¤íŠ¸-ë°-ê²€ì¦)
8. [ìš´ì˜ ê°€ì´ë“œ](#-ìš´ì˜-ê°€ì´ë“œ)

---

## ğŸ¯ ì‹œìŠ¤í…œ ê°œìš”

### ì„¤ê³„ ì² í•™: "Simple is Stable"
```
ë³µì¡í•œ 11ê°œ ì„œë¹„ìŠ¤ â†’ ê²€ì¦ëœ 4ê°œ í•µì‹¬ ì„œë¹„ìŠ¤
ì—”ì§€ë‹ˆì–´ë§ ì‡¼ì˜¤í”„ â†’ ì‹¤ì œ ìˆ˜ìµ ì°½ì¶œ
ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê³¼ì‰ â†’ í—¤ì§€í€ë“œê¸‰ ë‹¨ìˆœí•¨
```

### í•µì‹¬ ì§€í‘œ
- **ì‘ë‹µì‹œê°„**: < 100ms
- **ê°€ìš©ì„±**: 99.95%
- **ë¦¬ìŠ¤í¬**: ì¼ì¼ ìµœëŒ€ 2% ì†ì‹¤
- **ë ˆë²„ë¦¬ì§€**: 20x ISOLATED ê³ ì •
- **ê°œë°œì‹œê°„**: 1ê°œì›” (ê¸°ì¡´ 6ê°œì›” ëŒ€ë¹„ 83% ë‹¨ì¶•)

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ¦ í—¤ì§€í€ë“œê¸‰ Phoenix 95 ì‹œìŠ¤í…œ                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   SIGNAL    â”‚    â”‚    RISK     â”‚    â”‚   TRADE     â”‚      â”‚
â”‚  â”‚   ENGINE    â”‚â”€â”€â”€â–¶â”‚  GUARDIAN   â”‚â”€â”€â”€â–¶â”‚  EXECUTOR   â”‚      â”‚
â”‚  â”‚   :8100     â”‚    â”‚   :8101     â”‚    â”‚   :8102     â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                   â”‚                   â”‚           â”‚
â”‚         â”‚                   â”‚                   â”‚           â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                             â”‚                               â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                   â”‚    MONITOR &      â”‚                     â”‚
â”‚                   â”‚     ALERT         â”‚                     â”‚
â”‚                   â”‚      :8103        â”‚                     â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                             â”‚                               â”‚
â”‚                             â–¼                               â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                   â”‚    TELEGRAM       â”‚                     â”‚
â”‚                   â”‚     ALERTS        â”‚                     â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ë°ì´í„° íë¦„:
1. Signal Engine: AI ë¶„ì„ + ì‹ í˜¸ ê²€ì¦
2. Risk Guardian: ë¦¬ìŠ¤í¬ ì²´í¬ + í¬ì§€ì…˜ ì‚¬ì´ì§•
3. Trade Executor: ê±°ë˜ ì‹¤í–‰ + ìµì ˆ/ì†ì ˆ ì„¤ì •
4. Monitor & Alert: ì‹¤ì‹œê°„ ì¶”ì  + í…”ë ˆê·¸ë¨ ì•Œë¦¼
```

---

## âš¡ í•µì‹¬ 4ê°œ ì„œë¹„ìŠ¤

### 1. ğŸ§  Signal Engine (í¬íŠ¸: 8100)
**ì—­í• **: AI ë¶„ì„ + ì‹ í˜¸ ì²˜ë¦¬ í†µí•©
```python
ê¸°ëŠ¥:
- Phoenix 95 AI ë¶„ì„ (ê¸°ìˆ ì  + ê±°ë˜ëŸ‰ + ëª¨ë©˜í…€)
- ì‹ í˜¸ í’ˆì§ˆ ê²€ì¦
- ì¦‰ì‹œ ë¦¬ìŠ¤í¬ ì²´í¬ ì—°ë™
- ë‹¨ì¼ ì—”ë“œí¬ì¸íŠ¸: /analyze
```

### 2. ğŸ›¡ï¸ Risk Guardian (í¬íŠ¸: 8101)
**ì—­í• **: ë¦¬ìŠ¤í¬ ê´€ë¦¬ (ìµœìš°ì„ )
```python
ê¸°ëŠ¥:
- Kelly Criterion í¬ì§€ì…˜ ì‚¬ì´ì§•
- VaR ê³„ì‚° ë° í•œë„ ê´€ë¦¬
- ì‹¤ì‹œê°„ ë…¸ì¶œ ëª¨ë‹ˆí„°ë§
- í—¤ì§€í€ë“œê¸‰ ë¦¬ìŠ¤í¬ ê·œì¹™ ì ìš©
```

### 3. âš¡ Trade Executor (í¬íŠ¸: 8102)
**ì—­í• **: ê±°ë˜ ì‹¤í–‰
```python
ê¸°ëŠ¥:
- 20x ISOLATED ë ˆë²„ë¦¬ì§€ (ê³ ì •)
- 2% ìµì ˆ/ì†ì ˆ ìë™ ì„¤ì •
- Binance API ì§ì ‘ ì—°ë™
- ìŠ¬ë¦¬í”¼ì§€ ìµœì†Œí™”
```

### 4. ğŸ“Š Monitor & Alert (í¬íŠ¸: 8103)
**ì—­í• **: ëª¨ë‹ˆí„°ë§ + ì•Œë¦¼
```python
ê¸°ëŠ¥:
- í¬ì§€ì…˜ ì‹¤ì‹œê°„ ì¶”ì 
- P&L ê³„ì‚°
- í…”ë ˆê·¸ë¨ í•µì‹¬ ì•Œë¦¼
- ì‹œìŠ¤í…œ í—¬ìŠ¤ì²´í¬
```

---

## ğŸ’» ì™„ì „í•œ êµ¬í˜„ ì½”ë“œ

### main.py
```python
# ğŸ¦ í—¤ì§€í€ë“œê¸‰ Phoenix 95 ì‹œìŠ¤í…œ - ì™„ì „í•œ êµ¬í˜„
# ì €ì: Phoenix 95 Team
# ë²„ì „: 4.0.0 Hedge Fund Edition

import asyncio
import aiohttp
from fastapi import FastAPI, HTTPException
import uvicorn
from datetime import datetime
import numpy as np
import os
from dataclasses import dataclass
from typing import Optional, Dict, List
import requests
import multiprocessing
import json
import time
from concurrent.futures import ThreadPoolExecutor

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ¯ ê¸€ë¡œë²Œ ì„¤ì •
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

@dataclass
class HedgeFundConfig:
    """í—¤ì§€í€ë“œ ì„¤ì • (í•˜ë“œì½”ë”©ìœ¼ë¡œ ì•ˆì •ì„± í™•ë³´)"""
    # ë¦¬ìŠ¤í¬ ê´€ë¦¬ (ë³€ê²½ ê¸ˆì§€)
    MAX_DAILY_LOSS: float = 0.02      # 2%
    MAX_POSITION_SIZE: float = 0.05   # 5%
    LEVERAGE: int = 20                # 20x ê³ ì •
    STOP_LOSS: float = 0.02          # 2%
    TAKE_PROFIT: float = 0.02        # 2%
    MAX_POSITIONS: int = 3           # ìµœëŒ€ 3ê°œ ë™ì‹œ
    
    # Phoenix 95 ì„¤ì •
    MIN_CONFIDENCE: float = 0.75     # 75% ì´ìƒë§Œ ê±°ë˜
    PHOENIX_WEIGHT: float = 0.95     # Phoenix 95 ê°€ì¤‘ì¹˜
    
    # ì•Œë¦¼ ì„¤ì •
    TELEGRAM_TOKEN: str = "7386542811:AAEZ21p30rES1k8NxNM2xbZ53U44PI9D5CY"
    TELEGRAM_CHAT_ID: str = "7590895952"
    
    # ì„±ëŠ¥ ëª©í‘œ
    TARGET_RESPONSE_TIME: int = 100  # 100ms
    HEALTH_CHECK_INTERVAL: int = 30  # 30ì´ˆ

CONFIG = HedgeFundConfig()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ§  1. SIGNAL ENGINE (í¬íŠ¸: 8100)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

class Phoenix95Engine:
    """í—¤ì§€í€ë“œê¸‰ AI ì—”ì§„ - ê²€ì¦ëœ ë‹¨ìˆœí•¨"""
    
    def __init__(self):
        self.name = "Phoenix 95 V4 Hedge Fund Edition"
        self.version = "4.0.0"
        
    def analyze(self, data: Dict) -> Dict:
        """í•µì‹¬ 3ê°€ì§€ ì§€í‘œ ë¶„ì„ (í—¤ì§€í€ë“œ ê²€ì¦ëœ ë°©ì‹)"""
        start_time = time.time()
        
        try:
            # 1. ê¸°ìˆ ì  ë¶„ì„ (30%)
            technical_score = self._analyze_technical(data)
            
            # 2. ê±°ë˜ëŸ‰ ë¶„ì„ (30%)
            volume_score = self._analyze_volume(data)
            
            # 3. ëª¨ë©˜í…€ ë¶„ì„ (40%)
            momentum_score = self._analyze_momentum(data)
            
            # Phoenix 95 ìµœì¢… ì ìˆ˜ ê³„ì‚°
            raw_score = (
                technical_score * 0.3 + 
                volume_score * 0.3 + 
                momentum_score * 0.4
            )
            
            # Phoenix 95 ê°€ì¤‘ì¹˜ ì ìš©
            phoenix_score = raw_score * CONFIG.PHOENIX_WEIGHT
            
            # ì¶”ì²œ ë“±ê¸‰
            recommendation = self._get_recommendation(phoenix_score)
            
            # ì²˜ë¦¬ ì‹œê°„ ê³„ì‚°
            processing_time = (time.time() - start_time) * 1000
            
            return {
                'phoenix_score': round(phoenix_score, 4),
                'confidence': round(phoenix_score, 4),
                'recommendation': recommendation,
                'components': {
                    'technical': round(technical_score, 3),
                    'volume': round(volume_score, 3),
                    'momentum': round(momentum_score, 3)
                },
                'metadata': {
                    'engine': self.name,
                    'version': self.version,
                    'processing_time_ms': round(processing_time, 2),
                    'timestamp': datetime.now().isoformat()
                }
            }
            
        except Exception as e:
            return {
                'error': str(e),
                'phoenix_score': 0.0,
                'confidence': 0.0,
                'recommendation': 'ERROR'
            }
    
    def _analyze_technical(self, data: Dict) -> float:
        """ê¸°ìˆ ì  ì§€í‘œ ë¶„ì„"""
        rsi = data.get('rsi', 50)
        macd_line = data.get('macd_line', 0)
        macd_signal = data.get('macd_signal', 0)
        bb_position = data.get('bb_position', 0.5)  # ë³¼ë¦°ì €ë°´ë“œ ë‚´ ìœ„ì¹˜
        
        # RSI ì ìˆ˜ (í—¤ì§€í€ë“œ ê²€ì¦ ë¡œì§)
        if rsi < 30:
            rsi_score = 0.9      # ê°•í•œ ë§¤ìˆ˜ ì‹ í˜¸
        elif rsi < 40:
            rsi_score = 0.7
        elif rsi < 60:
            rsi_score = 0.5      # ì¤‘ë¦½
        elif rsi < 70:
            rsi_score = 0.3
        else:
            rsi_score = 0.1      # ê°•í•œ ë§¤ë„ ì‹ í˜¸
        
        # MACD ì ìˆ˜
        macd_diff = macd_line - macd_signal
        macd_score = 0.5 + (macd_diff / 100)  # ì •ê·œí™”
        macd_score = max(0, min(macd_score, 1))
        
        # ë³¼ë¦°ì €ë°´ë“œ ì ìˆ˜
        bb_score = bb_position  # 0~1 ì‚¬ì´ ê°’
        
        # ê°€ì¤‘ í‰ê· 
        technical_score = (rsi_score * 0.5 + macd_score * 0.3 + bb_score * 0.2)
        
        return max(0, min(technical_score, 1))
    
    def _analyze_volume(self, data: Dict) -> float:
        """ê±°ë˜ëŸ‰ ë¶„ì„"""
        current_volume = data.get('volume', 1000000)
        avg_volume = data.get('avg_volume_20', 1000000)
        
        if avg_volume == 0:
            return 0.5
        
        volume_ratio = current_volume / avg_volume
        
        # í—¤ì§€í€ë“œ ê±°ë˜ëŸ‰ í•´ì„
        if volume_ratio > 3.0:
            return 0.95     # í­ë°œì  ê±°ë˜ëŸ‰
        elif volume_ratio > 2.0:
            return 0.85     # ë§¤ìš° ë†’ì€ ê±°ë˜ëŸ‰
        elif volume_ratio > 1.5:
            return 0.75
        elif volume_ratio > 1.2:
            return 0.65
        elif volume_ratio > 0.8:
            return 0.55
        else:
            return 0.3      # ë‚®ì€ ê±°ë˜ëŸ‰
    
    def _analyze_momentum(self, data: Dict) -> float:
        """ëª¨ë©˜í…€ ë¶„ì„"""
        stoch_k = data.get('stoch_k', 50)
        stoch_d = data.get('stoch_d', 50)
        williams_r = data.get('williams_r', -50)
        cci = data.get('cci', 0)
        
        # Stochastic ì ìˆ˜
        if stoch_k < 20 and stoch_d < 20:
            stoch_score = 0.9   # ê³¼ë§¤ë„
        elif stoch_k > 80 and stoch_d > 80:
            stoch_score = 0.1   # ê³¼ë§¤ìˆ˜
        else:
            stoch_score = 0.5
        
        # Williams %R ì ìˆ˜
        if williams_r < -80:
            williams_score = 0.9
        elif williams_r > -20:
            williams_score = 0.1
        else:
            williams_score = 0.5
        
        # CCI ì ìˆ˜
        if cci < -100:
            cci_score = 0.9
        elif cci > 100:
            cci_score = 0.1
        else:
            cci_score = 0.5 + (cci / 200)  # ì •ê·œí™”
            cci_score = max(0, min(cci_score, 1))
        
        # ê°€ì¤‘ í‰ê· 
        momentum_score = (stoch_score * 0.4 + williams_score * 0.3 + cci_score * 0.3)
        
        return max(0, min(momentum_score, 1))
    
    def _get_recommendation(self, score: float) -> str:
        """ì¶”ì²œ ë“±ê¸‰ (í—¤ì§€í€ë“œ ê¸°ì¤€)"""
        if score > 0.85:
            return "STRONG_BUY"
        elif score > 0.75:
            return "BUY"
        elif score > 0.60:
            return "WEAK_BUY"
        elif score > 0.40:
            return "HOLD"
        elif score > 0.25:
            return "WEAK_SELL"
        elif score > 0.15:
            return "SELL"
        else:
            return "STRONG_SELL"

# Signal Engine FastAPI ì•±
signal_app = FastAPI(
    title="Phoenix 95 Signal Engine",
    version="4.0.0",
    description="í—¤ì§€í€ë“œê¸‰ AI ì‹ í˜¸ ë¶„ì„ ì—”ì§„"
)

phoenix_engine = Phoenix95Engine()

@signal_app.post("/analyze")
async def analyze_signal(data: dict):
    """í•µì‹¬ ì‹ í˜¸ ë¶„ì„ API"""
    try:
        # AI ë¶„ì„ ì‹¤í–‰
        analysis = phoenix_engine.analyze(data)
        
        # ê³ ì‹ ë¢°ë„ ì‹ í˜¸ì¸ ê²½ìš° ë¦¬ìŠ¤í¬ ì²´í¬
        if analysis['confidence'] > CONFIG.MIN_CONFIDENCE:
            risk_check = await call_service(
                'risk-guardian', 
                '/check',
                {'signal_data': data, 'analysis': analysis}
            )
            analysis['risk_check'] = risk_check
        
        return {
            'status': 'success',
            'analysis': analysis,
            'engine': 'Phoenix 95 V4 Hedge Fund',
            'timestamp': datetime.now().isoformat()
        }
        
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"ë¶„ì„ ì‹¤íŒ¨: {str(e)}")

@signal_app.get("/health")
async def health():
    return {
        'status': 'healthy',
        'service': 'signal_engine',
        'engine': phoenix_engine.name,
        'version': phoenix_engine.version,
        'timestamp': datetime.now().isoformat()
    }

@signal_app.get("/")
async def root():
    return {
        'service': 'Phoenix 95 Signal Engine',
        'version': '4.0.0',
        'description': 'í—¤ì§€í€ë“œê¸‰ AI ì‹ í˜¸ ë¶„ì„',
        'endpoints': {
            'analyze': 'POST /analyze',
            'health': 'GET /health'
        }
    }

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ›¡ï¸ 2. RISK GUARDIAN (í¬íŠ¸: 8101)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

class RiskGuardian:
    """í—¤ì§€í€ë“œê¸‰ ë¦¬ìŠ¤í¬ ê´€ë¦¬ ì‹œìŠ¤í…œ"""
    
    def __init__(self):
        # í˜„ì¬ ë¦¬ìŠ¤í¬ ìƒíƒœ
        self.daily_pnl = 0.0
        self.active_positions = 0
        self.total_exposure = 0.0
        self.position_history = []
        self.last_reset = datetime.now().date()
        
        # ë¦¬ìŠ¤í¬ ë©”íŠ¸ë¦­
        self.risk_metrics = {
            'daily_trades': 0,
            'success_rate': 0.0,
            'avg_holding_time': 0.0,
            'max_drawdown': 0.0
        }
    
    def check_trade_approval(self, signal_data: Dict, analysis: Dict) -> Dict:
        """ê±°ë˜ ìŠ¹ì¸ ì—¬ë¶€ ê²°ì • (í—¤ì§€í€ë“œ ì² ì €í•œ ê²€ì¦)"""
        
        checks = []
        approved = True
        risk_level = 'LOW'
        
        # ì¼ì¼ ë¦¬ì…‹ ì²´í¬
        self._check_daily_reset()
        
        # 1. ì¼ì¼ ì†ì‹¤ í•œë„ ì²´í¬ (ìµœìš°ì„ )
        if abs(self.daily_pnl) >= CONFIG.MAX_DAILY_LOSS:
            approved = False
            risk_level = 'CRITICAL'
            checks.append(f"ì¼ì¼ ì†ì‹¤ í•œë„ ì´ˆê³¼: {self.daily_pnl:.2%}")
        
        # 2. í¬ì§€ì…˜ ìˆ˜ í•œë„ ì²´í¬
        if self.active_positions >= CONFIG.MAX_POSITIONS:
            approved = False
            risk_level = 'HIGH'
            checks.append(f"ìµœëŒ€ í¬ì§€ì…˜ ìˆ˜ ë„ë‹¬: {self.active_positions}/{CONFIG.MAX_POSITIONS}")
        
        # 3. ì‹ ë¢°ë„ ì²´í¬
        confidence = analysis.get('confidence', 0)
        if confidence < CONFIG.MIN_CONFIDENCE:
            approved = False
            risk_level = 'MEDIUM'
            checks.append(f"ì‹ ë¢°ë„ ë¶€ì¡±: {confidence:.3f} < {CONFIG.MIN_CONFIDENCE}")
        
        # 4. í¬ì§€ì…˜ í¬ê¸° ê³„ì‚°
        account_balance = signal_data.get('account_balance', 10000)
        position_size = self._calculate_position_size(account_balance, confidence)
        
        # 5. ì´ ë…¸ì¶œ í•œë„ ì²´í¬
        projected_exposure = self.total_exposure + (position_size / account_balance)
        if projected_exposure > 0.20:  # ì´ 20% í•œë„
            approved = False
            risk_level = 'HIGH'
            checks.append(f"ì´ ë…¸ì¶œ í•œë„ ì´ˆê³¼: {projected_exposure:.2%}")
        
        # 6. ì‹œì¥ ì¡°ê±´ ì²´í¬
        market_condition = self._assess_market_condition(signal_data)
        if market_condition == 'HIGH_VOLATILITY' and len(checks) > 0:
            approved = False
            risk_level = 'HIGH'
            checks.append("ê³ ë³€ë™ì„± ì‹œì¥ì—ì„œ ì¶”ê°€ ë¦¬ìŠ¤í¬ ìš”ì¸ ì¡´ì¬")
        
        # ìŠ¹ì¸ëœ ê²½ìš°ì—ë§Œ í¬ì§€ì…˜ í¬ê¸° ì œê³µ
        final_position_size = position_size if approved else 0
        
        return {
            'approved': approved,
            'position_size': final_position_size,
            'position_size_pct': final_position_size / account_balance if account_balance > 0 else 0,
            'risk_level': risk_level,
            'checks': checks,
            'risk_metrics': {
                'current_exposure': self.total_exposure,
                'projected_exposure': projected_exposure,
                'daily_pnl': self.daily_pnl,
                'active_positions': self.active_positions,
                'market_condition': market_condition
            },
            'kelly_sizing': {
                'base_size': final_position_size * 0.8,  # ë³´ìˆ˜ì  ì¡°ì •
                'confidence_adjusted': final_position_size,
                'max_allowed': account_balance * CONFIG.MAX_POSITION_SIZE
            }
        }
    
    def _calculate_position_size(self, balance: float, confidence: float) -> float:
        """Kelly Criterion ê¸°ë°˜ ê³ ê¸‰ í¬ì§€ì…˜ ì‚¬ì´ì§•"""
        
        # ê¸°ë³¸ ë¦¬ìŠ¤í¬ (ê³„ì¢Œì˜ 2%)
        base_risk_amount = balance * CONFIG.MAX_DAILY_LOSS
        
        # ì‹ ë¢°ë„ ê¸°ë°˜ ì¡°ì • (75%-100% ì‹ ë¢°ë„ë¥¼ 0.8-1.2ë°°ë¡œ ë§¤í•‘)
        confidence_factor = 0.8 + (confidence - 0.75) * 1.6
        confidence_factor = max(0.5, min(confidence_factor, 1.2))
        
        # Kelly Criterion ê·¼ì‚¬ (ë‹¨ìˆœí™”ëœ ë²„ì „)
        # ê°€ì •: ìŠ¹ë¥  60%, í‰ê·  ìˆ˜ìµ/ì†ì‹¤ ë¹„ìœ¨ 1:1
        estimated_win_rate = 0.6 + (confidence - 0.75) * 0.4  # 0.6 ~ 1.0
        kelly_fraction = (estimated_win_rate * 2) - 1  # ë‹¨ìˆœí™”ëœ Kelly
        kelly_fraction = max(0.1, min(kelly_fraction, 0.25))  # 10%-25% ì œí•œ
        
        # ìµœì¢… í¬ì§€ì…˜ í¬ê¸° ê³„ì‚°
        kelly_size = balance * kelly_fraction
        confidence_adjusted_size = kelly_size * confidence_factor
        
        # ìµœëŒ€ í•œë„ ì ìš©
        max_position = balance * CONFIG.MAX_POSITION_SIZE
        final_size = min(confidence_adjusted_size, max_position)
        
        return final_size
    
    def _assess_market_condition(self, data: Dict) -> str:
        """ì‹œì¥ ì¡°ê±´ í‰ê°€"""
        volatility = data.get('volatility', 0.02)
        volume_ratio = data.get('volume', 1000) / data.get('avg_volume_20', 1000)
        
        if volatility > 0.05 or volume_ratio > 3.0:
            return 'HIGH_VOLATILITY'
        elif volatility > 0.03 or volume_ratio > 2.0:
            return 'MEDIUM_VOLATILITY'
        else:
            return 'NORMAL'
    
    def _check_daily_reset(self):
        """ì¼ì¼ ë¦¬ì…‹ ì²´í¬"""
        today = datetime.now().date()
        if today != self.last_reset:
            self.daily_pnl = 0.0
            self.risk_metrics['daily_trades'] = 0
            self.last_reset = today
    
    def update_position_status(self, position_update: Dict):
        """í¬ì§€ì…˜ ìƒíƒœ ì—…ë°ì´íŠ¸"""
        action = position_update.get('action')  # 'open', 'close', 'update'
        
        if action == 'open':
            self.active_positions += 1
            self.total_exposure += position_update.get('size_pct', 0)
            self.risk_metrics['daily_trades'] += 1
            
        elif action == 'close':
            self.active_positions = max(0, self.active_positions - 1)
            self.total_exposure -= position_update.get('size_pct', 0)
            self.total_exposure = max(0, self.total_exposure)
            
            # P&L ì—…ë°ì´íŠ¸
            pnl_pct = position_update.get('pnl_pct', 0)
            self.daily_pnl += pnl_pct
    
    def get_risk_report(self) -> Dict:
        """ë¦¬ìŠ¤í¬ ë³´ê³ ì„œ ìƒì„±"""
        return {
            'current_status': {
                'daily_pnl': self.daily_pnl,
                'active_positions': self.active_positions,
                'total_exposure': self.total_exposure,
                'risk_utilization': abs(self.daily_pnl) / CONFIG.MAX_DAILY_LOSS
            },
            'limits': {
                'max_daily_loss': CONFIG.MAX_DAILY_LOSS,
                'max_positions': CONFIG.MAX_POSITIONS,
                'max_position_size': CONFIG.MAX_POSITION_SIZE,
                'min_confidence': CONFIG.MIN_CONFIDENCE
            },
            'metrics': self.risk_metrics,
            'alerts': self._generate_alerts()
        }
    
    def _generate_alerts(self) -> List[str]:
        """ë¦¬ìŠ¤í¬ ì•Œë¦¼ ìƒì„±"""
        alerts = []
        
        if abs(self.daily_pnl) > CONFIG.MAX_DAILY_LOSS * 0.8:
            alerts.append("ì¼ì¼ ì†ì‹¤ì´ í•œë„ì˜ 80%ì— ë„ë‹¬")
            
        if self.active_positions >= CONFIG.MAX_POSITIONS * 0.8:
            alerts.append("í™œì„± í¬ì§€ì…˜ì´ í•œë„ì˜ 80%ì— ë„ë‹¬")
            
        if self.total_exposure > 0.15:
            alerts.append("ì´ ë…¸ì¶œì´ 15%ë¥¼ ì´ˆê³¼")
            
        return alerts

# Risk Guardian FastAPI ì•±
risk_app = FastAPI(
    title="Phoenix 95 Risk Guardian",
    version="4.0.0",
    description="í—¤ì§€í€ë“œê¸‰ ë¦¬ìŠ¤í¬ ê´€ë¦¬ ì‹œìŠ¤í…œ"
)

risk_guardian = RiskGuardian()

@risk_app.post("/check")
async def check_risk(data: dict):
    """ë¦¬ìŠ¤í¬ ì²´í¬ API"""
    try:
        signal_data = data.get('signal_data', {})
        analysis = data.get('analysis', {})
        
        result = risk_guardian.check_trade_approval(signal_data, analysis)
        
        return {
            'status': 'success',
            'risk_check': result,
            'timestamp': datetime.now().isoformat()
        }
        
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"ë¦¬ìŠ¤í¬ ì²´í¬ ì‹¤íŒ¨: {str(e)}")

@risk_app.post("/update")
async def update_position(data: dict):
    """í¬ì§€ì…˜ ìƒíƒœ ì—…ë°ì´íŠ¸"""
    try:
        risk_guardian.update_position_status(data)
        return {'status': 'updated', 'timestamp': datetime.now().isoformat()}
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {str(e)}")

@risk_app.get("/status")
async def risk_status():
    """ë¦¬ìŠ¤í¬ ìƒíƒœ ì¡°íšŒ"""
    return risk_guardian.get_risk_report()

@risk_app.get("/health")
async def health():
    return {
        'status': 'healthy',
        'service': 'risk_guardian',
        'active_positions': risk_guardian.active_positions,
        'daily_pnl': risk_guardian.daily_pnl,
        'timestamp': datetime.now().isoformat()
    }

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# âš¡ 3. TRADE EXECUTOR (í¬íŠ¸: 8102)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

class TradeExecutor:
    """í—¤ì§€í€ë“œê¸‰ ê±°ë˜ ì‹¤í–‰ ì‹œìŠ¤í…œ"""
    
    def __init__(self):
        self.api_key = os.getenv('BINANCE_API_KEY')
        self.api_secret = os.getenv('BINANCE_SECRET')
        self.test_mode = os.getenv('TRADE_MODE', 'TEST') == 'TEST'
        
        # ê±°ë˜ ì„¤ì • (í—¤ì§€í€ë“œ ê¸°ì¤€)
        self.leverage = CONFIG.LEVERAGE
        self.stop_loss_pct = CONFIG.STOP_LOSS
        self.take_profit_pct = CONFIG.TAKE_PROFIT
        
        # ê±°ë˜ í†µê³„
        self.execution_stats = {
            'total_trades': 0,
            'successful_trades': 0,
            'failed_trades': 0,
            'avg_execution_time': 0.0,
            'total_volume': 0.0
        }
    
    async def execute_trade(self, signal: Dict, risk_approval: Dict) -> Dict:
        """ê±°ë˜ ì‹¤í–‰ (í—¤ì§€í€ë“œ ë°©ì‹)"""
        
        if not risk_approval.get('approved'):
            return {
                'status': 'rejected',
                'reason': 'Risk not approved',
                'risk_checks': risk_approval.get('checks', [])
            }
        
        execution_start = time.time()
        
        try:
            # 1. ë ˆë²„ë¦¬ì§€ ì„¤ì •
            leverage_result = await self._set_leverage(signal['symbol'])
            
            # 2. í¬ì§€ì…˜ í¬ê¸° ìµœì¢… í™•ì¸
            position_size = risk_approval['position_size']
            if position_size <= 0:
                return {'status': 'rejected', 'reason': 'Invalid position size'}
            
            # 3. ì£¼ë¬¸ ì‹¤í–‰
            order_result = await self._place_order(
                symbol=signal['symbol'],
                side=signal['side'],
                quantity=position_size,
                price=signal.get('price', 0)
            )
            
            if order_result['status'] == 'FILLED':
                # 4. ìµì ˆ/ì†ì ˆ ì£¼ë¬¸ ì„¤ì •
                stop_orders = await self._set_stop_orders(order_result, signal['side'])
                
                # 5. ì‹¤í–‰ í†µê³„ ì—…ë°ì´íŠ¸
                execution_time = (time.time() - execution_start) * 1000
                self._update_execution_stats(execution_time, position_size, True)
                
                # 6. Risk Guardianì— í¬ì§€ì…˜ ì˜¤í”ˆ ì•Œë¦¼
                await call_service('risk-guardian', '/update', {
                    'action': 'open',
                    'size_pct': position_size / signal.get('account_balance', 10000),
                    'symbol': signal['symbol']
                })
                
                return {
                    'status': 'executed',
                    'execution_time_ms': round(execution_time, 2),
                    'order_details': {
                        'order_id': order_result['orderId'],
                        'symbol': signal['symbol'],
                        'side': signal['side'],
                        'executed_price': order_result['price'],
                        'executed_qty': order_result['executedQty'],
                        'leverage': self.leverage
                    },
                    'risk_management': {
                        'stop_loss_price': stop_orders['stop_loss'],
                        'take_profit_price': stop_orders['take_profit'],
                        'liquidation_price': self._calculate_liquidation_price(
                            order_result['price'], signal['side']
                        )
                    },
                    'metadata': {
                        'execution_mode': 'TEST' if self.test_mode else 'LIVE',
                        'timestamp': datetime.now().isoformat()
                    }
                }
            else:
                self._update_execution_stats(0, 0, False)
                return {
                    'status': 'failed',
                    'reason': f"Order failed: {order_result.get('msg', 'Unknown error')}"
                }
                
        except Exception as e:
            self._update_execution_stats(0, 0, False)
            return {
                'status': 'error',
                'error': str(e),
                'timestamp': datetime.now().isoformat()
            }
    
    async def _set_leverage(self, symbol: str) -> Dict:
        """ë ˆë²„ë¦¬ì§€ ì„¤ì •"""
        if self.test_mode:
            print(f"[TEST MODE] Setting {symbol} leverage to {self.leverage}x ISOLATED")
            return {'status': 'success', 'leverage': self.leverage}
        
        # ì‹¤ì œ Binance API í˜¸ì¶œì€ ì—¬ê¸°ì— êµ¬í˜„
        # í˜„ì¬ëŠ” ì‹œë®¬ë ˆì´ì…˜
        return {'status': 'success', 'leverage': self.leverage}
    
    async def _place_order(self, symbol: str, side: str, quantity: float, price: float) -> Dict:
        """ì£¼ë¬¸ ì‹¤í–‰"""
        if self.test_mode:
            # í…ŒìŠ¤íŠ¸ ëª¨ë“œ: ì‹œë®¬ë ˆì´ì…˜
            order_id = f"TEST_{int(time.time() * 1000)}"
            print(f"[TEST MODE] Placing {side} order: {symbol} @ ${price:,.2f}, qty: {quantity:,.2f}")
            
            return {
                'orderId': order_id,
                'status': 'FILLED',
                'price': price,
                'executedQty': quantity,
                'symbol': symbol,
                'side': side
            }
        
        # ì‹¤ì œ Binance API í˜¸ì¶œ
        # í˜„ì¬ëŠ” ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ ëŒ€ì²´
        return {
            'orderId': f"LIVE_{int(time.time() * 1000)}",
            'status': 'FILLED',
            'price': price,
            'executedQty': quantity
        }
    
    async def _set_stop_orders(self, order_result: Dict, side: str) -> Dict:
        """ìµì ˆ/ì†ì ˆ ì£¼ë¬¸ ì„¤ì •"""
        entry_price = float(order_result['price'])
        
        if side == 'BUY':
            stop_loss = entry_price * (1 - self.stop_loss_pct)
            take_profit = entry_price * (1 + self.take_profit_pct)
        else:  # SELL
            stop_loss = entry_price * (1 + self.stop_loss_pct)
            take_profit = entry_price * (1 - self.take_profit_pct)
        
        if self.test_mode:
            print(f"[TEST MODE] Stop orders set - SL: ${stop_loss:,.2f}, TP: ${take_profit:,.2f}")
        
        return {
            'stop_loss': stop_loss,
            'take_profit': take_profit
        }
    
    def _calculate_liquidation_price(self, entry_price: float, side: str) -> float:
        """ì²­ì‚°ê°€ ê³„ì‚°"""
        maintenance_margin = 0.004  # 0.4%
        
        if side == 'BUY':
            liquidation_price = entry_price * (1 - (1/self.leverage) + maintenance_margin)
        else:  # SELL
            liquidation_price = entry_price * (1 + (1/self.leverage) - maintenance_margin)
        
        return liquidation_price
    
    def _update_execution_stats(self, execution_time: float, volume: float, success: bool):
        """ì‹¤í–‰ í†µê³„ ì—…ë°ì´íŠ¸"""
        self.execution_stats['total_trades'] += 1
        
        if success:
            self.execution_stats['successful_trades'] += 1
            self.execution_stats['total_volume'] += volume
            
            # í‰ê·  ì‹¤í–‰ ì‹œê°„ ì—…ë°ì´íŠ¸
            current_avg = self.execution_stats['avg_execution_time']
            total_successful = self.execution_stats['successful_trades']
            new_avg = ((current_avg * (total_successful - 1)) + execution_time) / total_successful
            self.execution_stats['avg_execution_time'] = new_avg
        else:
            self.execution_stats['failed_trades'] += 1
    
    def get_execution_report(self) -> Dict:
        """ì‹¤í–‰ ë³´ê³ ì„œ"""
        total = self.execution_stats['total_trades']
        success_rate = (
            self.execution_stats['successful_trades'] / total * 100 
            if total > 0 else 0
        )
        
        return {
            'execution_stats': {
                **self.execution_stats,
                'success_rate_pct': round(success_rate, 2)
            },
            'configuration': {
                'leverage': self.leverage,
                'stop_loss_pct': self.stop_loss_pct,
                'take_profit_pct': self.take_profit_pct,
                'test_mode': self.test_mode
            }
        }

# Trade Executor FastAPI ì•±
trade_app = FastAPI(
    title="Phoenix 95 Trade Executor",
    version="4.0.0",
    description="í—¤ì§€í€ë“œê¸‰ ê±°ë˜ ì‹¤í–‰ ì‹œìŠ¤í…œ"
)

trade_executor = TradeExecutor()

@trade_app.post("/execute")
async def execute_trade(data: dict):
    """ê±°ë˜ ì‹¤í–‰ API"""
    try:
        signal = data.get('signal', {})
        risk_approval = data.get('risk_approval', {})
        
        result = await trade_executor.execute_trade(signal, risk_approval)
        
        return {
            'status': 'success',
            'execution_result': result,
            'timestamp': datetime.now().isoformat()
        }
        
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"ê±°ë˜ ì‹¤í–‰ ì‹¤íŒ¨: {str(e)}")

@trade_app.get("/stats")
async def execution_stats():
    """ì‹¤í–‰ í†µê³„ ì¡°íšŒ"""
    return trade_executor.get_execution_report()

@trade_app.get("/health")
async def health():
    stats = trade_executor.execution_stats
    return {
        'status': 'healthy',
        'service': 'trade_executor',
        'total_trades': stats['total_trades'],
        'success_rate': (
            stats['successful_trades'] / stats['total_trades'] * 100
            if stats['total_trades'] > 0 else 0
        ),
        'test_mode': trade_executor.test_mode,
        'timestamp': datetime.now().isoformat()
    }

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“Š 4. MONITOR & ALERT (í¬íŠ¸: 8103)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

class MonitorAlert:
    """í—¤ì§€í€ë“œê¸‰ ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼ ì‹œìŠ¤í…œ"""
    
    def __init__(self):
        self.telegram_token = CONFIG.TELEGRAM_TOKEN
        self.chat_id = CONFIG.TELEGRAM_CHAT_ID
        
        # í¬ì§€ì…˜ ì¶”ì 
        self.positions = {}
        self.alerts_sent = set()
        
        # ì„±ëŠ¥ ë©”íŠ¸ë¦­
        self.performance_metrics = {
            'total_pnl': 0.0,
            'win_rate': 0.0,
            'avg_trade_duration': 0.0,
            'max_drawdown': 0.0,
            'sharpe_ratio': 0.0
        }
    
    async def send_trade_alert(self, trade_data: Dict):
        """ê±°ë˜ ì•Œë¦¼ ì „ì†¡"""
        execution_result = trade_data.get('execution_result', {})
        
        if execution_result.get('status') == 'executed':
            order_details = execution_result.get('order_details', {})
            risk_mgmt = execution_result.get('risk_management', {})
            
            message = f"""
ğŸ¦ <b>í—¤ì§€í€ë“œ ê±°ë˜ ì‹¤í–‰</b>

ğŸ“Š <b>ê¸°ë³¸ ì •ë³´</b>
â€¢ ì‹¬ë³¼: <code>{order_details.get('symbol', 'UNKNOWN')}</code>
â€¢ ë°©í–¥: <b>{order_details.get('side', 'UNKNOWN')}</b>
â€¢ ê°€ê²©: <code>${order_details.get('executed_price', 0):,.2f}</code>
â€¢ ìˆ˜ëŸ‰: <code>{order_details.get('executed_qty', 0):,.4f}</code>

âš¡ <b>ë ˆë²„ë¦¬ì§€ ì •ë³´</b>
â€¢ ë ˆë²„ë¦¬ì§€: <b>{order_details.get('leverage', 20)}x ISOLATED</b>
â€¢ ì²­ì‚°ê°€: <code>${risk_mgmt.get('liquidation_price', 0):,.2f}</code>

ğŸ¯ <b>ë¦¬ìŠ¤í¬ ê´€ë¦¬</b>
â€¢ ìµì ˆê°€: <code>${risk_mgmt.get('take_profit_price', 0):,.2f}</code> (+{CONFIG.TAKE_PROFIT:.1%})
â€¢ ì†ì ˆê°€: <code>${risk_mgmt.get('stop_loss_price', 0):,.2f}</code> (-{CONFIG.STOP_LOSS:.1%})

ğŸ“ˆ <b>ì‹¤í–‰ ì •ë³´</b>
â€¢ ì‹¤í–‰ì‹œê°„: {execution_result.get('execution_time_ms', 0):.1f}ms
â€¢ ì£¼ë¬¸ID: <code>{order_details.get('order_id', 'N/A')}</code>
â€¢ ëª¨ë“œ: {execution_result.get('metadata', {}).get('execution_mode', 'UNKNOWN')}

â° {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
"""
            await self._send_telegram(message)
            
        elif execution_result.get('status') == 'rejected':
            message = f"""
ğŸš« <b>ê±°ë˜ ê±°ì ˆ</b>

âŒ <b>ê±°ì ˆ ì‚¬ìœ :</b> {execution_result.get('reason', 'Unknown')}

ğŸ” <b>ë¦¬ìŠ¤í¬ ì²´í¬:</b>
{chr(10).join(f"â€¢ {check}" for check in execution_result.get('risk_checks', []))}

â° {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
"""
            await self._send_telegram(message)
    
    async def send_system_alert(self, alert_type: str, message: str, severity: str = 'INFO'):
        """ì‹œìŠ¤í…œ ì•Œë¦¼ ì „ì†¡"""
        emoji_map = {
            'INFO': 'â„¹ï¸',
            'WARNING': 'âš ï¸',
            'ERROR': 'âŒ',
            'CRITICAL': 'ğŸš¨'
        }
        
        emoji = emoji_map.get(severity, 'â„¹ï¸')
        
        formatted_message = f"""
{emoji} <b>ì‹œìŠ¤í…œ ì•Œë¦¼</b>

ğŸ“‹ <b>ìœ í˜•:</b> {alert_type}
ğŸ” <b>ë‚´ìš©:</b> {message}
ğŸ“Š <b>ì‹¬ê°ë„:</b> {severity}

â° {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
"""
        await self._send_telegram(formatted_message)
    
    async def send_performance_report(self):
        """ì„±ëŠ¥ ë³´ê³ ì„œ ì „ì†¡"""
        # ê° ì„œë¹„ìŠ¤ì—ì„œ ì„±ëŠ¥ ë°ì´í„° ìˆ˜ì§‘
        performance_data = await self._collect_performance_data()
        
        message = f"""
ğŸ“ˆ <b>Phoenix 95 ì„±ëŠ¥ ë³´ê³ ì„œ</b>

ğŸ¦ <b>ì „ì²´ ì„±ëŠ¥</b>
â€¢ ì´ P&L: <b>{performance_data.get('total_pnl', 0):+.2%}</b>
â€¢ ìŠ¹ë¥ : <b>{performance_data.get('win_rate', 0):.1%}</b>
â€¢ ìµœëŒ€ ì†ì‹¤: <b>{performance_data.get('max_drawdown', 0):.2%}</b>
â€¢ ìƒ¤í”„ ë¹„ìœ¨: <b>{performance_data.get('sharpe_ratio', 0):.2f}</b>

âš¡ <b>ê±°ë˜ í†µê³„</b>
â€¢ ì´ ê±°ë˜: {performance_data.get('total_trades', 0)}íšŒ
â€¢ í‰ê·  ë³´ìœ ì‹œê°„: {performance_data.get('avg_duration', 0):.1f}ë¶„
â€¢ ì‹¤í–‰ ì„±ê³µë¥ : {performance_data.get('execution_success_rate', 0):.1%}

ğŸ›¡ï¸ <b>ë¦¬ìŠ¤í¬ í˜„í™©</b>
â€¢ í™œì„± í¬ì§€ì…˜: {performance_data.get('active_positions', 0)}ê°œ
â€¢ ì´ ë…¸ì¶œ: {performance_data.get('total_exposure', 0):.1%}
â€¢ ì¼ì¼ P&L: {performance_data.get('daily_pnl', 0):+.2%}

â° {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
"""
        await self._send_telegram(message)
    
    async def _collect_performance_data(self) -> Dict:
        """ì„±ëŠ¥ ë°ì´í„° ìˆ˜ì§‘"""
        try:
            # Risk Guardianì—ì„œ ë¦¬ìŠ¤í¬ í˜„í™© ìˆ˜ì§‘
            risk_data = await call_service('risk-guardian', '/status', {})
            
            # Trade Executorì—ì„œ ê±°ë˜ í†µê³„ ìˆ˜ì§‘
            trade_data = await call_service('trade-executor', '/stats', {})
            
            return {
                'total_pnl': risk_data.get('current_status', {}).get('daily_pnl', 0),
                'active_positions': risk_data.get('current_status', {}).get('active_positions', 0),
                'total_exposure': risk_data.get('current_status', {}).get('total_exposure', 0),
                'daily_pnl': risk_data.get('current_status', {}).get('daily_pnl', 0),
                'total_trades': trade_data.get('execution_stats', {}).get('total_trades', 0),
                'execution_success_rate': trade_data.get('execution_stats', {}).get('success_rate_pct', 0),
                'win_rate': 0.0,  # ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ê³„ì‚° ë¡œì§ ì¶”ê°€
                'max_drawdown': 0.0,
                'sharpe_ratio': 0.0,
                'avg_duration': 0.0
            }
        except:
            return {}
    
    async def _send_telegram(self, message: str):
        """í…”ë ˆê·¸ë¨ ë©”ì‹œì§€ ì „ì†¡"""
        url = f"https://api.telegram.org/bot{self.telegram_token}/sendMessage"
        data = {
            'chat_id': self.chat_id,
            'text': message,
            'parse_mode': 'HTML',
            'disable_web_page_preview': True
        }
        
        try:
            response = requests.post(url, data=data, timeout=10)
            if response.status_code == 200:
                print(f"âœ… í…”ë ˆê·¸ë¨ ì•Œë¦¼ ì „ì†¡ ì„±ê³µ")
            else:
                print(f"âŒ í…”ë ˆê·¸ë¨ ì „ì†¡ ì‹¤íŒ¨: HTTP {response.status_code}")
                print(f"Response: {response.text}")
        except Exception as e:
            print(f"âŒ í…”ë ˆê·¸ë¨ ì˜¤ë¥˜: {e}")
    
    async def health_check_all_services(self) -> Dict:
        """ì „ì²´ ì„œë¹„ìŠ¤ í—¬ìŠ¤ì²´í¬"""
        services = {
            'signal_engine': 'http://localhost:8100/health',
            'risk_guardian': 'http://localhost:8101/health',
            'trade_executor': 'http://localhost:8102/health'
        }
        
        results = {}
        healthy_count = 0
        
        for service_name, url in services.items():
            try:
                start_time = time.time()
                response = requests.get(url, timeout=5)
                response_time = (time.time() - start_time) * 1000
                
                if response.status_code == 200:
                    results[service_name] = {
                        'status': 'healthy',
                        'response_time_ms': round(response_time, 2),
                        'data': response.json()
                    }
                    healthy_count += 1
                else:
                    results[service_name] = {
                        'status': 'unhealthy',
                        'http_status': response.status_code
                    }
            except Exception as e:
                results[service_name] = {
                    'status': 'unreachable',
                    'error': str(e)
                }
        
        overall_status = 'healthy' if healthy_count == len(services) else 'degraded'
        
        return {
            'overall_status': overall_status,
            'healthy_services': healthy_count,
            'total_services': len(services),
            'services': results,
            'timestamp': datetime.now().isoformat()
        }

# Monitor & Alert FastAPI ì•±
monitor_app = FastAPI(
    title="Phoenix 95 Monitor & Alert",
    version="4.0.0",
    description="í—¤ì§€í€ë“œê¸‰ ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼ ì‹œìŠ¤í…œ"
)

monitor_alert = MonitorAlert()

@monitor_app.post("/alert/trade")
async def trade_alert(data: dict):
    """ê±°ë˜ ì•Œë¦¼"""
    await monitor_alert.send_trade_alert(data)
    return {'status': 'sent', 'timestamp': datetime.now().isoformat()}

@monitor_app.post("/alert/system")
async def system_alert(data: dict):
    """ì‹œìŠ¤í…œ ì•Œë¦¼"""
    alert_type = data.get('type', 'SYSTEM')
    message = data.get('message', 'Unknown system event')
    severity = data.get('severity', 'INFO')
    
    await monitor_alert.send_system_alert(alert_type, message, severity)
    return {'status': 'sent', 'timestamp': datetime.now().isoformat()}

@monitor_app.get("/health/all")
async def health_check_all():
    """ì „ì²´ ì‹œìŠ¤í…œ í—¬ìŠ¤ì²´í¬"""
    return await monitor_alert.health_check_all_services()

@monitor_app.post("/report/performance")
async def performance_report():
    """ì„±ëŠ¥ ë³´ê³ ì„œ ì „ì†¡"""
    await monitor_alert.send_performance_report()
    return {'status': 'sent', 'timestamp': datetime.now().isoformat()}

@monitor_app.get("/health")
async def health():
    return {
        'status': 'healthy',
        'service': 'monitor_alert',
        'telegram_configured': bool(monitor_alert.telegram_token),
        'timestamp': datetime.now().isoformat()
    }

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ”§ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

async def call_service(service_name: str, endpoint: str, data: Dict) -> Dict:
    """ì„œë¹„ìŠ¤ ê°„ í†µì‹ """
    service_ports = {
        'signal-engine': 8100,
        'risk-guardian': 8101,
        'trade-executor': 8102,
        'monitor-alert': 8103
    }
    
    port = service_ports.get(service_name)
    if not port:
        return {'error': f'Unknown service: {service_name}'}
    
    url = f"http://localhost:{port}{endpoint}"
    
    try:
        if endpoint.startswith('/health') or endpoint.startswith('/status'):
            # GET ìš”ì²­
            async with aiohttp.ClientSession() as session:
                async with session.get(url, timeout=5) as response:
                    if response.status == 200:
                        return await response.json()
                    else:
                        return {'error': f'HTTP {response.status}'}
        else:
            # POST ìš”ì²­
            async with aiohttp.ClientSession() as session:
                async with session.post(url, json=data, timeout=10) as response:
                    if response.status == 200:
                        return await response.json()
                    else:
                        return {'error': f'HTTP {response.status}'}
                        
    except asyncio.TimeoutError:
        return {'error': 'Timeout'}
    except Exception as e:
        return {'error': str(e)}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸš€ ë©”ì¸ ì‹œìŠ¤í…œ ëŸ°ì²˜
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def run_signal_engine():
    """Signal Engine ì‹¤í–‰"""
    uvicorn.run(signal_app, host="0.0.0.0", port=8100, log_level="error")

def run_risk_guardian():
    """Risk Guardian ì‹¤í–‰"""
    uvicorn.run(risk_app, host="0.0.0.0", port=8101, log_level="error")

def run_trade_executor():
    """Trade Executor ì‹¤í–‰"""
    uvicorn.run(trade_app, host="0.0.0.0", port=8102, log_level="error")

def run_monitor_alert():
    """Monitor & Alert ì‹¤í–‰"""
    uvicorn.run(monitor_app, host="0.0.0.0", port=8103, log_level="error")

async def system_health_monitor():
    """ì‹œìŠ¤í…œ í—¬ìŠ¤ ëª¨ë‹ˆí„°ë§"""
    print("ğŸ” ì‹œìŠ¤í…œ í—¬ìŠ¤ ëª¨ë‹ˆí„°ë§ ì‹œì‘...")
    
    while True:
        try:
            # ì „ì²´ ì‹œìŠ¤í…œ í—¬ìŠ¤ì²´í¬
            health_data = await monitor_alert.health_check_all_services()
            
            # ìƒíƒœ ì¶œë ¥
            timestamp = datetime.now().strftime('%H:%M:%S')
            status = health_data['overall_status']
            healthy = health_data['healthy_services']
            total = health_data['total_services']
            
            status_emoji = 'âœ…' if status == 'healthy' else 'âš ï¸'
            print(f"{status_emoji} [{timestamp}] ì‹œìŠ¤í…œ ìƒíƒœ: {status.upper()} ({healthy}/{total})")
            
            # ê° ì„œë¹„ìŠ¤ ìƒíƒœ ì¶œë ¥
            for service, data in health_data['services'].items():
                service_status = data['status']
                if service_status == 'healthy':
                    response_time = data.get('response_time_ms', 0)
                    print(f"   âœ… {service}: OK ({response_time:.1f}ms)")
                else:
                    error = data.get('error', data.get('http_status', 'Unknown'))
                    print(f"   âŒ {service}: {error}")
            
            # ì‹¬ê°í•œ ë¬¸ì œ ë°œìƒì‹œ ì•Œë¦¼
            if healthy < total:
                await monitor_alert.send_system_alert(
                    'HEALTH_CHECK',
                    f'ì„œë¹„ìŠ¤ ìƒíƒœ ì´ìƒ: {healthy}/{total} ì •ìƒ',
                    'WARNING' if healthy > 0 else 'CRITICAL'
                )
            
            print()  # ë¹ˆ ì¤„ ì¶”ê°€
            await asyncio.sleep(CONFIG.HEALTH_CHECK_INTERVAL)
            
        except KeyboardInterrupt:
            print("\nğŸ‘‹ í—¬ìŠ¤ ëª¨ë‹ˆí„°ë§ ì¢…ë£Œ")
            break
        except Exception as e:
            print(f"âŒ í—¬ìŠ¤ì²´í¬ ì˜¤ë¥˜: {e}")
            await asyncio.sleep(10)

def start_hedge_fund_system():
    """í—¤ì§€í€ë“œ ì‹œìŠ¤í…œ ë©”ì¸ ëŸ°ì²˜"""
    
    print("=" * 60)
    print("ğŸ¦ Phoenix 95 í—¤ì§€í€ë“œê¸‰ ì‹œìŠ¤í…œ ì‹œì‘")
    print("=" * 60)
    print()
    print("ğŸ¯ ì„œë¹„ìŠ¤ êµ¬ì„±:")
    print("   âœ… Signal Engine (AI ë¶„ì„): http://localhost:8100")
    print("   ğŸ›¡ï¸ Risk Guardian (ë¦¬ìŠ¤í¬): http://localhost:8101")
    print("   âš¡ Trade Executor (ê±°ë˜): http://localhost:8102")
    print("   ğŸ“Š Monitor & Alert (ì•Œë¦¼): http://localhost:8103")
    print()
    print("ğŸ”§ ì„¤ì •:")
    print(f"   â€¢ ë ˆë²„ë¦¬ì§€: {CONFIG.LEVERAGE}x ISOLATED")
    print(f"   â€¢ ìµì ˆ/ì†ì ˆ: Â±{CONFIG.STOP_LOSS:.1%}")
    print(f"   â€¢ ìµœì†Œ ì‹ ë¢°ë„: {CONFIG.MIN_CONFIDENCE:.1%}")
    print(f"   â€¢ ìµœëŒ€ ì¼ì¼ì†ì‹¤: {CONFIG.MAX_DAILY_LOSS:.1%}")
    print()
    print("=" * 60)
    
    # ë©€í‹°í”„ë¡œì„¸ì‹±ìœ¼ë¡œ ì„œë¹„ìŠ¤ ì‹œì‘
    processes = [
        multiprocessing.Process(target=run_signal_engine, name="SignalEngine"),
        multiprocessing.Process(target=run_risk_guardian, name="RiskGuardian"),
        multiprocessing.Process(target=run_trade_executor, name="TradeExecutor"),
        multiprocessing.Process(target=run_monitor_alert, name="MonitorAlert")
    ]
    
    # ëª¨ë“  í”„ë¡œì„¸ìŠ¤ ì‹œì‘
    for process in processes:
        process.start()
        print(f"ğŸš€ {process.name} ì‹œì‘ë¨")
    
    print()
    print("â³ ì„œë¹„ìŠ¤ ì´ˆê¸°í™” ëŒ€ê¸° ì¤‘...")
    time.sleep(5)  # ì„œë¹„ìŠ¤ ì‹œì‘ ëŒ€ê¸°
    
    # ì‹œì‘ ì•Œë¦¼ ì „ì†¡
    asyncio.run(send_startup_notification())
    
    try:
        # í—¬ìŠ¤ ëª¨ë‹ˆí„°ë§ ì‹œì‘
        asyncio.run(system_health_monitor())
    except KeyboardInterrupt:
        print("\nğŸ›‘ ì‹œìŠ¤í…œ ì¢…ë£Œ ì¤‘...")
        
        # ëª¨ë“  í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
        for process in processes:
            process.terminate()
            process.join(timeout=5)
            if process.is_alive():
                process.kill()
        
        print("âœ… ëª¨ë“  ì„œë¹„ìŠ¤ê°€ ì•ˆì „í•˜ê²Œ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")

async def send_startup_notification():
    """ì‹œì‘ ì•Œë¦¼ ì „ì†¡"""
    try:
        message = f"""
ğŸš€ <b>Phoenix 95 í—¤ì§€í€ë“œ ì‹œìŠ¤í…œ ì‹œì‘</b>

ğŸ¦ <b>ì‹œìŠ¤í…œ êµ¬ì„±</b>
â€¢ Signal Engine: AI ë¶„ì„ ì—”ì§„
â€¢ Risk Guardian: ë¦¬ìŠ¤í¬ ê´€ë¦¬
â€¢ Trade Executor: ê±°ë˜ ì‹¤í–‰
â€¢ Monitor & Alert: ëª¨ë‹ˆí„°ë§

âš™ï¸ <b>ì„¤ì •</b>
â€¢ ë ˆë²„ë¦¬ì§€: {CONFIG.LEVERAGE}x ISOLATED
â€¢ ìµì ˆ/ì†ì ˆ: Â±{CONFIG.STOP_LOSS:.1%}
â€¢ ìµœì†Œ ì‹ ë¢°ë„: {CONFIG.MIN_CONFIDENCE:.1%}
â€¢ ìµœëŒ€ ì¼ì¼ì†ì‹¤: {CONFIG.MAX_DAILY_LOSS:.1%}

âœ… <b>ìƒíƒœ: ìš´ì˜ ì¤€ë¹„ ì™„ë£Œ</b>

â° {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
"""
        await monitor_alert._send_telegram(message)
    except:
        pass  # ì•Œë¦¼ ì‹¤íŒ¨í•´ë„ ì‹œìŠ¤í…œì€ ê³„ì† ë™ì‘

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ¯ ë©”ì¸ ì‹¤í–‰ë¶€
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if __name__ == "__main__":
    # í™˜ê²½ë³€ìˆ˜ ì²´í¬
    print("ğŸ”§ í™˜ê²½ ì„¤ì • ì²´í¬...")
    
    required_env = ['TELEGRAM_TOKEN', 'TELEGRAM_CHAT_ID']
    missing_env = []
    
    for env_var in required_env:
        if not os.getenv(env_var):
            # ê¸°ë³¸ê°’ ì‚¬ìš©
            if env_var == 'TELEGRAM_TOKEN':
                os.environ[env_var] = CONFIG.TELEGRAM_TOKEN
            elif env_var == 'TELEGRAM_CHAT_ID':
                os.environ[env_var] = CONFIG.TELEGRAM_CHAT_ID
    
    # ê±°ë˜ ëª¨ë“œ ì„¤ì •
    if not os.getenv('TRADE_MODE'):
        os.environ['TRADE_MODE'] = 'TEST'  # ê¸°ë³¸ê°’: í…ŒìŠ¤íŠ¸ ëª¨ë“œ
    
    trade_mode = os.getenv('TRADE_MODE', 'TEST')
    print(f"ğŸ“Š ê±°ë˜ ëª¨ë“œ: {trade_mode}")
    
    if trade_mode == 'LIVE':
        binance_key = os.getenv('BINANCE_API_KEY')
        binance_secret = os.getenv('BINANCE_SECRET')
        
        if not binance_key or not binance_secret:
            print("âš ï¸  LIVE ëª¨ë“œì´ì§€ë§Œ Binance API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•ŠìŒ")
            print("   TEST ëª¨ë“œë¡œ ì‹¤í–‰í•˜ê±°ë‚˜ API í‚¤ë¥¼ ì„¤ì •í•˜ì„¸ìš”:")
            print("   export BINANCE_API_KEY='your_key'")
            print("   export BINANCE_SECRET='your_secret'")
            print("   export TRADE_MODE='LIVE'")
            print()
    
    print("âœ… í™˜ê²½ ì„¤ì • ì™„ë£Œ")
    print()
    
    # ì‹œìŠ¤í…œ ì‹œì‘
    start_hedge_fund_system()

"""
ğŸ¦ Phoenix 95 í—¤ì§€í€ë“œê¸‰ ì‹œìŠ¤í…œ - ì‚¬ìš© ê°€ì´ë“œ

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‹ ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. ì„¤ì¹˜:
   pip install fastapi uvicorn aiohttp requests numpy

2. ì‹¤í–‰:
   python main.py

3. í…ŒìŠ¤íŠ¸:
   curl -X POST localhost:8100/analyze \\
     -H "Content-Type: application/json" \\
     -d '{"symbol":"BTCUSDT","price":45000,"rsi":25,"volume":2000000}'

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”§ í™˜ê²½ ì„¤ì •
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ê¸°ë³¸ ì„¤ì • (í…ŒìŠ¤íŠ¸ ëª¨ë“œ)
export TRADE_MODE=TEST

# ì‹¤ì œ ê±°ë˜ (ì£¼ì˜!)
export TRADE_MODE=LIVE
export BINANCE_API_KEY=your_key
export BINANCE_SECRET=your_secret

# í…”ë ˆê·¸ë¨ ì•Œë¦¼ (ì˜µì…˜)
export TELEGRAM_TOKEN=your_token
export TELEGRAM_CHAT_ID=your_chat_id

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¯ API ì—”ë“œí¬ì¸íŠ¸
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Signal Engine (8100):
- POST /analyze: AI ì‹ í˜¸ ë¶„ì„
- GET /health: ìƒíƒœ í™•ì¸

Risk Guardian (8101):
- POST /check: ë¦¬ìŠ¤í¬ ì²´í¬
- GET /status: ë¦¬ìŠ¤í¬ í˜„í™©
- POST /update: í¬ì§€ì…˜ ì—…ë°ì´íŠ¸

Trade Executor (8102):
- POST /execute: ê±°ë˜ ì‹¤í–‰
- GET /stats: ì‹¤í–‰ í†µê³„

Monitor & Alert (8103):
- GET /health/all: ì „ì²´ í—¬ìŠ¤ì²´í¬
- POST /alert/trade: ê±°ë˜ ì•Œë¦¼
- POST /alert/system: ì‹œìŠ¤í…œ ì•Œë¦¼

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’¡ í—¤ì§€í€ë“œê¸‰ íŠ¹ì§•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… ë‹¨ìˆœí•¨: 4ê°œ í•µì‹¬ ì„œë¹„ìŠ¤
âœ… ì•ˆì •ì„±: ë¦¬ìŠ¤í¬ ìš°ì„  ì ‘ê·¼ë²•
âœ… ì†ë„: 100ms ëª©í‘œ ì‘ë‹µì‹œê°„
âœ… ì‹ ë¢°ì„±: ìë™ í—¬ìŠ¤ì²´í¬
âœ… íˆ¬ëª…ì„±: ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§

ğŸ¯ í•µì‹¬ ì›ì¹™:
"Simple systems work. Complex systems break."
"""


# =============================================================================
# ğŸ¦ Phoenix 95 í—¤ì§€í€ë“œê¸‰ ì‹œìŠ¤í…œ - Docker ë°°í¬ ì„¤ì •
# =============================================================================

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# docker-compose.yml - ë©”ì¸ ë°°í¬ íŒŒì¼
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

version: '3.8'

services:
  # ğŸ§  Signal Engine - AI ë¶„ì„
  signal-engine:
    build: 
      context: .
      dockerfile: Dockerfile.signal
    container_name: phoenix95-signal-engine
    ports:
      - "8100:8100"
    environment:
      - SERVICE_NAME=signal_engine
      - SERVICE_PORT=8100
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8100/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    restart: unless-stopped
    networks:
      - phoenix95-network

  # ğŸ›¡ï¸ Risk Guardian - ë¦¬ìŠ¤í¬ ê´€ë¦¬
  risk-guardian:
    build: 
      context: .
      dockerfile: Dockerfile.risk
    container_name: phoenix95-risk-guardian
    ports:
      - "8101:8101"
    environment:
      - SERVICE_NAME=risk_guardian
      - SERVICE_PORT=8101
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8101/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    restart: unless-stopped
    networks:
      - phoenix95-network
    depends_on:
      - signal-engine

  # âš¡ Trade Executor - ê±°ë˜ ì‹¤í–‰
  trade-executor:
    build: 
      context: .
      dockerfile: Dockerfile.trade
    container_name: phoenix95-trade-executor
    ports:
      - "8102:8102"
    environment:
      - SERVICE_NAME=trade_executor
      - SERVICE_PORT=8102
      - TRADE_MODE=${TRADE_MODE:-TEST}
      - BINANCE_API_KEY=${BINANCE_API_KEY:-}
      - BINANCE_SECRET=${BINANCE_SECRET:-}
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8102/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    restart: unless-stopped
    networks:
      - phoenix95-network
    depends_on:
      - risk-guardian

  # ğŸ“Š Monitor & Alert - ëª¨ë‹ˆí„°ë§
  monitor-alert:
    build: 
      context: .
      dockerfile: Dockerfile.monitor
    container_name: phoenix95-monitor-alert
    ports:
      - "8103:8103"
    environment:
      - SERVICE_NAME=monitor_alert
      - SERVICE_PORT=8103
      - TELEGRAM_TOKEN=${TELEGRAM_TOKEN:-7386542811:AAEZ21p30rES1k8NxNM2xbZ53U44PI9D5CY}
      - TELEGRAM_CHAT_ID=${TELEGRAM_CHAT_ID:-7590895952}
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8103/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    restart: unless-stopped
    networks:
      - phoenix95-network
    depends_on:
      - trade-executor

  # ğŸ—„ï¸ Redis - ìºì‹œ (ì„ íƒì‚¬í•­)
  redis:
    image: redis:7-alpine
    container_name: phoenix95-redis
    ports:
      - "6379:6379"
    command: redis-server --appendonly yes
    volumes:
      - redis_data:/data
    restart: unless-stopped
    networks:
      - phoenix95-network

networks:
  phoenix95-network:
    driver: bridge
    name: phoenix95-hedge-fund

volumes:
  redis_data:
    driver: local

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# .env - í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# ğŸ¦ Phoenix 95 í™˜ê²½ ì„¤ì •
# ë³µì‚¬ í›„ .env íŒŒì¼ë¡œ ì €ì¥í•˜ê³  ì‹¤ì œ ê°’ìœ¼ë¡œ ìˆ˜ì •í•˜ì„¸ìš”

# ê±°ë˜ ëª¨ë“œ (TEST ë˜ëŠ” LIVE)
TRADE_MODE=TEST

# Binance API (LIVE ëª¨ë“œì‹œ í•„ìˆ˜)
BINANCE_API_KEY=your_binance_api_key_here
BINANCE_SECRET=your_binance_secret_here

# í…”ë ˆê·¸ë¨ ì•Œë¦¼ (ê¸°ë³¸ê°’ ì œê³µë¨)
TELEGRAM_TOKEN=7386542811:AAEZ21p30rES1k8NxNM2xbZ53U44PI9D5CY
TELEGRAM_CHAT_ID=7590895952

# ì‹œìŠ¤í…œ ì„¤ì •
LOG_LEVEL=INFO
HEALTH_CHECK_INTERVAL=30

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Dockerfile.signal - Signal Engine
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

FROM python:3.11-slim

WORKDIR /app

# ì˜ì¡´ì„± ì„¤ì¹˜
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# ì†ŒìŠ¤ ì½”ë“œ ë³µì‚¬
COPY main.py .

# í—¬ìŠ¤ì²´í¬ìš© curl ì„¤ì¹˜
RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*

# í¬íŠ¸ ë…¸ì¶œ
EXPOSE 8100

# Signal Engine ì‹¤í–‰
CMD ["python", "-c", "from main import run_signal_engine; run_signal_engine()"]

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Dockerfile.risk - Risk Guardian
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY main.py .

RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*

EXPOSE 8101

CMD ["python", "-c", "from main import run_risk_guardian; run_risk_guardian()"]

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Dockerfile.trade - Trade Executor
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY main.py .

RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*

EXPOSE 8102

CMD ["python", "-c", "from main import run_trade_executor; run_trade_executor()"]

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Dockerfile.monitor - Monitor & Alert
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY main.py .

RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*

EXPOSE 8103

CMD ["python", "-c", "from main import run_monitor_alert; run_monitor_alert()"]

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# requirements.txt - Python ì˜ì¡´ì„±
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# ğŸ¦ Phoenix 95 í—¤ì§€í€ë“œê¸‰ ì‹œìŠ¤í…œ ì˜ì¡´ì„±

# ì›¹ í”„ë ˆì„ì›Œí¬
fastapi==0.104.1
uvicorn[standard]==0.24.0

# HTTP í´ë¼ì´ì–¸íŠ¸
aiohttp==3.9.1
requests==2.31.0

# ë°ì´í„° ì²˜ë¦¬
numpy==1.24.3
pandas==2.0.3

# ì¶”ê°€ ìœ í‹¸ë¦¬í‹°
python-multipart==0.0.6
python-dotenv==1.0.0

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# start.sh - ë¹ ë¥¸ ì‹œì‘ ìŠ¤í¬ë¦½íŠ¸ (Linux/macOS)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

#!/bin/bash

# ğŸ¦ Phoenix 95 í—¤ì§€í€ë“œê¸‰ ì‹œìŠ¤í…œ ë¹ ë¥¸ ì‹œì‘

echo "ğŸ¦ Phoenix 95 í—¤ì§€í€ë“œê¸‰ ì‹œìŠ¤í…œ ì‹œì‘"
echo "============================================"

# í™˜ê²½ ì²´í¬
if ! command -v docker &> /dev/null; then
    echo "âŒ Dockerê°€ ì„¤ì¹˜ë˜ì§€ ì•ŠìŒ"
    echo "   https://docs.docker.com/get-docker/ ì—ì„œ ì„¤ì¹˜í•˜ì„¸ìš”"
    exit 1
fi

if ! command -v docker-compose &> /dev/null; then
    echo "âŒ Docker Composeê°€ ì„¤ì¹˜ë˜ì§€ ì•ŠìŒ"
    echo "   https://docs.docker.com/compose/install/ ì—ì„œ ì„¤ì¹˜í•˜ì„¸ìš”"
    exit 1
fi

# .env íŒŒì¼ ì²´í¬
if [ ! -f .env ]; then
    echo "ğŸ“ .env íŒŒì¼ ìƒì„± ì¤‘..."
    cat > .env << EOF
# Phoenix 95 í™˜ê²½ ì„¤ì •
TRADE_MODE=TEST
BINANCE_API_KEY=your_binance_api_key_here
BINANCE_SECRET=your_binance_secret_here
TELEGRAM_TOKEN=7386542811:AAEZ21p30rES1k8NxNM2xbZ53U44PI9D5CY
TELEGRAM_CHAT_ID=7590895952
LOG_LEVEL=INFO
HEALTH_CHECK_INTERVAL=30
EOF
    echo "âœ… .env íŒŒì¼ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤"
    echo "âš ï¸  ì‹¤ì œ ê±°ë˜ë¥¼ ìœ„í•´ì„œëŠ” .env íŒŒì¼ì˜ API í‚¤ë¥¼ ìˆ˜ì •í•˜ì„¸ìš”"
fi

# Docker ì´ë¯¸ì§€ ë¹Œë“œ ë° ì‹œì‘
echo "ğŸ³ Docker ì»¨í…Œì´ë„ˆ ì‹œì‘ ì¤‘..."
docker-compose up --build -d

# í—¬ìŠ¤ì²´í¬ ëŒ€ê¸°
echo "â³ ì„œë¹„ìŠ¤ ì´ˆê¸°í™” ëŒ€ê¸° ì¤‘..."
sleep 10

# í—¬ìŠ¤ì²´í¬
echo "ğŸ” ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸ ì¤‘..."
services=("8100" "8101" "8102" "8103")
all_healthy=true

for port in "${services[@]}"; do
    if curl -f http://localhost:$port/health >/dev/null 2>&1; then
        echo "âœ… í¬íŠ¸ $port: ì •ìƒ"
    else
        echo "âŒ í¬íŠ¸ $port: ë¹„ì •ìƒ"
        all_healthy=false
    fi
done

if [ "$all_healthy" = true ]; then
    echo ""
    echo "ğŸ‰ Phoenix 95 ì‹œìŠ¤í…œì´ ì„±ê³µì ìœ¼ë¡œ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤!"
    echo ""
    echo "ğŸ“‹ ì ‘ì† ì •ë³´:"
    echo "   ğŸ§  Signal Engine: http://localhost:8100"
    echo "   ğŸ›¡ï¸ Risk Guardian: http://localhost:8101"
    echo "   âš¡ Trade Executor: http://localhost:8102"
    echo "   ğŸ“Š Monitor & Alert: http://localhost:8103"
    echo ""
    echo "ğŸ§ª í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´:"
    echo "   curl -X POST http://localhost:8100/analyze \\"
    echo "     -H 'Content-Type: application/json' \\"
    echo "     -d '{\"symbol\":\"BTCUSDT\",\"price\":45000,\"rsi\":25}'"
    echo ""
    echo "ğŸ›‘ ì¤‘ì§€: docker-compose down"
else
    echo ""
    echo "âš ï¸ ì¼ë¶€ ì„œë¹„ìŠ¤ì— ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤"
    echo "   ë¡œê·¸ í™•ì¸: docker-compose logs"
fi

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# start.bat - ë¹ ë¥¸ ì‹œì‘ ìŠ¤í¬ë¦½íŠ¸ (Windows)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

@echo off
setlocal enabledelayedexpansion

echo ğŸ¦ Phoenix 95 í—¤ì§€í€ë“œê¸‰ ì‹œìŠ¤í…œ ì‹œì‘
echo ============================================

REM Docker ì²´í¬
docker --version >nul 2>&1
if %errorlevel% neq 0 (
    echo âŒ Dockerê°€ ì„¤ì¹˜ë˜ì§€ ì•ŠìŒ
    echo    https://docs.docker.com/get-docker/ ì—ì„œ ì„¤ì¹˜í•˜ì„¸ìš”
    pause
    exit /b 1
)

docker-compose --version >nul 2>&1
if %errorlevel% neq 0 (
    echo âŒ Docker Composeê°€ ì„¤ì¹˜ë˜ì§€ ì•ŠìŒ
    echo    https://docs.docker.com/compose/install/ ì—ì„œ ì„¤ì¹˜í•˜ì„¸ìš”
    pause
    exit /b 1
)

REM .env íŒŒì¼ ì²´í¬
if not exist .env (
    echo ğŸ“ .env íŒŒì¼ ìƒì„± ì¤‘...
    (
        echo # Phoenix 95 í™˜ê²½ ì„¤ì •
        echo TRADE_MODE=TEST
        echo BINANCE_API_KEY=your_binance_api_key_here
        echo BINANCE_SECRET=your_binance_secret_here
        echo TELEGRAM_TOKEN=7386542811:AAEZ21p30rES1k8NxNM2xbZ53U44PI9D5CY
        echo TELEGRAM_CHAT_ID=7590895952
        echo LOG_LEVEL=INFO
        echo HEALTH_CHECK_INTERVAL=30
    ) > .env
    echo âœ… .env íŒŒì¼ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤
    echo âš ï¸  ì‹¤ì œ ê±°ë˜ë¥¼ ìœ„í•´ì„œëŠ” .env íŒŒì¼ì˜ API í‚¤ë¥¼ ìˆ˜ì •í•˜ì„¸ìš”
)

REM Docker ì»¨í…Œì´ë„ˆ ì‹œì‘
echo ğŸ³ Docker ì»¨í…Œì´ë„ˆ ì‹œì‘ ì¤‘...
docker-compose up --build -d

REM í—¬ìŠ¤ì²´í¬ ëŒ€ê¸°
echo â³ ì„œë¹„ìŠ¤ ì´ˆê¸°í™” ëŒ€ê¸° ì¤‘...
timeout /t 10 /nobreak >nul

REM í—¬ìŠ¤ì²´í¬
echo ğŸ” ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸ ì¤‘...
set all_healthy=true

for %%p in (8100 8101 8102 8103) do (
    curl -f http://localhost:%%p/health >nul 2>&1
    if !errorlevel! equ 0 (
        echo âœ… í¬íŠ¸ %%p: ì •ìƒ
    ) else (
        echo âŒ í¬íŠ¸ %%p: ë¹„ì •ìƒ
        set all_healthy=false
    )
)

if "!all_healthy!"=="true" (
    echo.
    echo ğŸ‰ Phoenix 95 ì‹œìŠ¤í…œì´ ì„±ê³µì ìœ¼ë¡œ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤!
    echo.
    echo ğŸ“‹ ì ‘ì† ì •ë³´:
    echo    ğŸ§  Signal Engine: http://localhost:8100
    echo    ğŸ›¡ï¸ Risk Guardian: http://localhost:8101
    echo    âš¡ Trade Executor: http://localhost:8102
    echo    ğŸ“Š Monitor ^& Alert: http://localhost:8103
    echo.
    echo ğŸ§ª í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´:
    echo    ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:8100 ì ‘ì†
    echo.
    echo ğŸ›‘ ì¤‘ì§€: docker-compose down
) else (
    echo.
    echo âš ï¸ ì¼ë¶€ ì„œë¹„ìŠ¤ì— ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤
    echo    ë¡œê·¸ í™•ì¸: docker-compose logs
)

pause

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# test.sh - í†µí•© í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

#!/bin/bash

# ğŸ§ª Phoenix 95 í†µí•© í…ŒìŠ¤íŠ¸

echo "ğŸ§ª Phoenix 95 í—¤ì§€í€ë“œê¸‰ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸"
echo "========================================"

# í…ŒìŠ¤íŠ¸ ë°ì´í„°
test_signal='{
  "symbol": "BTCUSDT",
  "price": 45000,
  "side": "BUY",
  "rsi": 25,
  "volume": 2000000,
  "avg_volume_20": 1500000,
  "macd_line": 0.5,
  "macd_signal": 0.3,
  "stoch_k": 25,
  "stoch_d": 20,
  "williams_r": -75,
  "cci": -150,
  "account_balance": 10000
}'

echo "1. ğŸ§  Signal Engine í…ŒìŠ¤íŠ¸..."
response=$(curl -s -X POST http://localhost:8100/analyze \
  -H "Content-Type: application/json" \
  -d "$test_signal")

if [[ $? -eq 0 ]]; then
    echo "âœ… Signal Engine: OK"
    phoenix_score=$(echo $response | grep -o '"phoenix_score":[^,]*' | cut -d':' -f2)
    echo "   Phoenix 95 ì ìˆ˜: $phoenix_score"
else
    echo "âŒ Signal Engine: FAIL"
    exit 1
fi

echo ""
echo "2. ğŸ›¡ï¸ Risk Guardian í…ŒìŠ¤íŠ¸..."
risk_data="{
  \"signal_data\": $test_signal,
  \"analysis\": $response
}"

risk_response=$(curl -s -X POST http://localhost:8101/check \
  -H "Content-Type: application/json" \
  -d "$risk_data")

if [[ $? -eq 0 ]]; then
    echo "âœ… Risk Guardian: OK"
    approved=$(echo $risk_response | grep -o '"approved":[^,]*' | cut -d':' -f2)
    echo "   ê±°ë˜ ìŠ¹ì¸: $approved"
else
    echo "âŒ Risk Guardian: FAIL"
    exit 1
fi

echo ""
echo "3. âš¡ Trade Executor í…ŒìŠ¤íŠ¸..."
trade_data="{
  \"signal\": $test_signal,
  \"risk_approval\": $risk_response
}"

trade_response=$(curl -s -X POST http://localhost:8102/execute \
  -H "Content-Type: application/json" \
  -d "$trade_data")

if [[ $? -eq 0 ]]; then
    echo "âœ… Trade Executor: OK"
    status=$(echo $trade_response | grep -o '"status":"[^"]*' | cut -d'"' -f4)
    echo "   ì‹¤í–‰ ìƒíƒœ: $status"
else
    echo "âŒ Trade Executor: FAIL"
    exit 1
fi

echo ""
echo "4. ğŸ“Š Monitor & Alert í…ŒìŠ¤íŠ¸..."
health_response=$(curl -s http://localhost:8103/health/all)

if [[ $? -eq 0 ]]; then
    echo "âœ… Monitor & Alert: OK"
    overall_status=$(echo $health_response | grep -o '"overall_status":"[^"]*' | cut -d'"' -f4)
    echo "   ì „ì²´ ì‹œìŠ¤í…œ ìƒíƒœ: $overall_status"
else
    echo "âŒ Monitor & Alert: FAIL"
    exit 1
fi

echo ""
echo "ğŸ‰ ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼!"
echo "ğŸ“Š ì‹œìŠ¤í…œì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ê³  ìˆìŠµë‹ˆë‹¤."

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ì‚¬ìš© ê°€ì´ë“œ
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# ğŸ¦ Phoenix 95 í—¤ì§€í€ë“œê¸‰ ì‹œìŠ¤í…œ - ì™„ì „í•œ ë°°í¬ ê°€ì´ë“œ

## ğŸ“¦ íŒŒì¼ êµ¬ì„±

phoenix95-hedge-fund/
â”œâ”€â”€ main.py                 # ë©”ì¸ ì‹œìŠ¤í…œ ì½”ë“œ
â”œâ”€â”€ docker-compose.yml      # Docker êµ¬ì„±
â”œâ”€â”€ .env                    # í™˜ê²½ ë³€ìˆ˜
â”œâ”€â”€ requirements.txt        # Python ì˜ì¡´ì„±
â”œâ”€â”€ Dockerfile.signal       # Signal Engine ì´ë¯¸ì§€
â”œâ”€â”€ Dockerfile.risk         # Risk Guardian ì´ë¯¸ì§€
â”œâ”€â”€ Dockerfile.trade        # Trade Executor ì´ë¯¸ì§€
â”œâ”€â”€ Dockerfile.monitor      # Monitor & Alert ì´ë¯¸ì§€
â”œâ”€â”€ start.sh               # Linux/macOS ì‹œì‘ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ start.bat              # Windows ì‹œì‘ ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ test.sh                # í†µí•© í…ŒìŠ¤íŠ¸

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### Linux/macOS:
chmod +x start.sh
./start.sh

### Windows:
start.bat

### Docker ìˆ˜ë™ ì‹¤í–‰:
docker-compose up --build -d

## ğŸ§ª í…ŒìŠ¤íŠ¸
chmod +x test.sh
./test.sh

## ğŸ›‘ ì¤‘ì§€
docker-compose down

## ğŸ“‹ í™˜ê²½ ì„¤ì •

.env íŒŒì¼ì—ì„œ ë‹¤ìŒ ì„¤ì • ìˆ˜ì •:

# ì‹¤ì œ ê±°ë˜ì‹œ:
TRADE_MODE=LIVE
BINANCE_API_KEY=ì‹¤ì œ_API_í‚¤
BINANCE_SECRET=ì‹¤ì œ_ì‹œí¬ë¦¿

# í…”ë ˆê·¸ë¨ ì•Œë¦¼:
TELEGRAM_TOKEN=ë´‡_í† í°
TELEGRAM_CHAT_ID=ì±„íŒ…_ID

## ğŸ”§ ë¬¸ì œ í•´ê²°

### í¬íŠ¸ ì¶©ëŒ:
netstat -tulpn | grep :8100
sudo lsof -ti:8100 | xargs kill -9

### ë¡œê·¸ í™•ì¸:
docker-compose logs -f

### ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘:
docker-compose restart

## ğŸ“Š ëª¨ë‹ˆí„°ë§

- ì „ì²´ ìƒíƒœ: http://localhost:8103/health/all
- Signal Engine: http://localhost:8100/health
- Risk Guardian: http://localhost:8101/status
- Trade Executor: http://localhost:8102/stats

## ğŸ¯ API ì‚¬ìš© ì˜ˆì‹œ

# ì‹ í˜¸ ë¶„ì„:
curl -X POST http://localhost:8100/analyze \
  -H "Content-Type: application/json" \
  -d '{"symbol":"BTCUSDT","price":45000,"rsi":25}'

# ë¦¬ìŠ¤í¬ ìƒíƒœ:
curl http://localhost:8101/status

# ê±°ë˜ í†µê³„:
curl http://localhost:8102/stats

# ì „ì²´ í—¬ìŠ¤ì²´í¬:
curl http://localhost:8103/health/all



# ğŸ¦ Phoenix 95 í—¤ì§€í€ë“œê¸‰ ì‹œìŠ¤í…œ - ì™„ì „í•œ ê°€ì´ë“œ

## ğŸ“‹ ëª©ì°¨
1. [ì‹œìŠ¤í…œ ê°œìš”](#-ì‹œìŠ¤í…œ-ê°œìš”)
2. [ë¹ ë¥¸ ì‹œì‘ (3ë¶„)](#-ë¹ ë¥¸-ì‹œì‘-3ë¶„)
3. [ìƒì„¸ ì„¤ì¹˜ ê°€ì´ë“œ](#-ìƒì„¸-ì„¤ì¹˜-ê°€ì´ë“œ)
4. [ì„¤ì • ë° í™˜ê²½ë³€ìˆ˜](#-ì„¤ì •-ë°-í™˜ê²½ë³€ìˆ˜)
5. [API ì‚¬ìš©ë²•](#-api-ì‚¬ìš©ë²•)
6. [ëª¨ë‹ˆí„°ë§ ë° ìš´ì˜](#-ëª¨ë‹ˆí„°ë§-ë°-ìš´ì˜)
7. [ë¬¸ì œ í•´ê²°](#-ë¬¸ì œ-í•´ê²°)
8. [ì„±ëŠ¥ ìµœì í™”](#-ì„±ëŠ¥-ìµœì í™”)

---

## ğŸ¯ ì‹œìŠ¤í…œ ê°œìš”

### ì„¤ê³„ ì² í•™: í—¤ì§€í€ë“œê¸‰ ë‹¨ìˆœí•¨
```
âœ… 4ê°œ í•µì‹¬ ì„œë¹„ìŠ¤ (ê¸°ì¡´ 11ê°œ ëŒ€ë¹„ 70% ë‹¨ìˆœí™”)
âœ… 100ms ì‘ë‹µì‹œê°„ ëª©í‘œ (ê¸°ì¡´ 1000ms ëŒ€ë¹„ 10ë°° í–¥ìƒ)
âœ… ë¦¬ìŠ¤í¬ ìš°ì„  ì ‘ê·¼ë²• (í—¤ì§€í€ë“œ ë°©ì‹)
âœ… ì›í´ë¦­ ë°°í¬ (30ì´ˆ ë‚´ ì „ì²´ ì‹œìŠ¤í…œ êµ¬ë™)
```

### í•µì‹¬ ì„œë¹„ìŠ¤ êµ¬ì„±
```
ğŸ§  Signal Engine (8100) - AI ë¶„ì„ + ì‹ í˜¸ ì²˜ë¦¬
ğŸ›¡ï¸ Risk Guardian (8101) - ë¦¬ìŠ¤í¬ ê´€ë¦¬ (ìµœìš°ì„ )
âš¡ Trade Executor (8102) - ê±°ë˜ ì‹¤í–‰
ğŸ“Š Monitor & Alert (8103) - ëª¨ë‹ˆí„°ë§ + ì•Œë¦¼
```

---

## ğŸš€ ë¹ ë¥¸ ì‹œì‘ (3ë¶„)

### 1ë‹¨ê³„: íŒŒì¼ ì¤€ë¹„ (30ì´ˆ)
```bash
# ìƒˆ ë””ë ‰í† ë¦¬ ìƒì„±
mkdir phoenix95-hedge-fund && cd phoenix95-hedge-fund

# í•„ìš”í•œ íŒŒì¼ë“¤ ìƒì„± (ì•ì„œ ì œê³µëœ ì½”ë“œë“¤ ë³µì‚¬)
# - main.py (ë©”ì¸ ì‹œìŠ¤í…œ ì½”ë“œ)
# - docker-compose.yml (Docker ì„¤ì •)
# - requirements.txt (Python ì˜ì¡´ì„±)
# - .env (í™˜ê²½ ë³€ìˆ˜)
```

### 2ë‹¨ê³„: Docker ì‹¤í–‰ (1ë¶„)
```bash
# Linux/macOS
./start.sh

# Windows  
start.bat

# ë˜ëŠ” ìˆ˜ë™ ì‹¤í–‰
docker-compose up --build -d
```

### 3ë‹¨ê³„: í…ŒìŠ¤íŠ¸ (1ë¶„)
```bash
# ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸
curl http://localhost:8103/health/all

# AI ë¶„ì„ í…ŒìŠ¤íŠ¸
curl -X POST http://localhost:8100/analyze \
  -H "Content-Type: application/json" \
  -d '{"symbol":"BTCUSDT","price":45000,"rsi":25,"volume":2000000}'
```

### ì ‘ì† í™•ì¸
```
âœ… Signal Engine: http://localhost:8100
âœ… Risk Guardian: http://localhost:8101
âœ… Trade Executor: http://localhost:8102
âœ… Monitor & Alert: http://localhost:8103
```

---

## ğŸ“¦ ìƒì„¸ ì„¤ì¹˜ ê°€ì´ë“œ

### ìš”êµ¬ì‚¬í•­
```bash
# í•„ìˆ˜
- Docker 20.10+
- Docker Compose 2.0+
- curl (í…ŒìŠ¤íŠ¸ìš©)

# ì„ íƒì‚¬í•­
- Python 3.11+ (ë¡œì»¬ ê°œë°œì‹œ)
- Git (ì†ŒìŠ¤ ê´€ë¦¬ì‹œ)
```

### ì„¤ì¹˜ ë‹¨ê³„ë³„ ê°€ì´ë“œ

#### 1. í™˜ê²½ ì¤€ë¹„
```bash
# Docker ì„¤ì¹˜ í™•ì¸
docker --version
docker-compose --version

# í¬íŠ¸ ì‚¬ìš© í™•ì¸ (8100-8103)
netstat -tulpn | grep -E "810[0-3]"
```

#### 2. í”„ë¡œì íŠ¸ êµ¬ì¡° ìƒì„±
```
phoenix95-hedge-fund/
â”œâ”€â”€ ğŸ“„ main.py                 # ë©”ì¸ ì‹œìŠ¤í…œ (3,000+ lines)
â”œâ”€â”€ ğŸ³ docker-compose.yml      # Docker êµ¬ì„±
â”œâ”€â”€ âš™ï¸ .env                    # í™˜ê²½ ë³€ìˆ˜
â”œâ”€â”€ ğŸ“¦ requirements.txt        # ì˜ì¡´ì„±
â”œâ”€â”€ ğŸ–¼ï¸ Dockerfile.*           # ê° ì„œë¹„ìŠ¤ìš© ì´ë¯¸ì§€
â”œâ”€â”€ ğŸš€ start.sh/.bat          # ì‹œì‘ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ ğŸ§ª test.sh                # í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ ğŸ“š README.md              # ì´ ë¬¸ì„œ
```

#### 3. í•µì‹¬ íŒŒì¼ ìƒì„±

**main.py** (3,000+ lines - ì™„ì „í•œ êµ¬í˜„)
```python
# ì•ì„œ ì œê³µëœ ì™„ì „í•œ êµ¬í˜„ ì½”ë“œ ì‚¬ìš©
# - 4ê°œ í•µì‹¬ ì„œë¹„ìŠ¤ ì™„ì „ êµ¬í˜„
# - Phoenix 95 AI ì—”ì§„
# - í—¤ì§€í€ë“œê¸‰ ë¦¬ìŠ¤í¬ ê´€ë¦¬
# - ì‹¤ì œ ê±°ë˜ ì‹¤í–‰ ë¡œì§
# - í…”ë ˆê·¸ë¨ ì•Œë¦¼ ì‹œìŠ¤í…œ
```

**docker-compose.yml**
```yaml
# ì•ì„œ ì œê³µëœ Docker ì„¤ì • ì‚¬ìš©
# - 4ê°œ ì„œë¹„ìŠ¤ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
# - ìë™ í—¬ìŠ¤ì²´í¬
# - ë„¤íŠ¸ì›Œí¬ ì„¤ì •
# - ë³¼ë¥¨ ê´€ë¦¬
```

**.env í…œí”Œë¦¿**
```bash
# ê¸°ë³¸ ì„¤ì •
TRADE_MODE=TEST
TELEGRAM_TOKEN=7386542811:AAEZ21p30rES1k8NxNM2xbZ53U44PI9D5CY
TELEGRAM_CHAT_ID=7590895952

# ì‹¤ì œ ê±°ë˜ì‹œ í•„ìˆ˜
BINANCE_API_KEY=your_key_here
BINANCE_SECRET=your_secret_here
```

---

## âš™ï¸ ì„¤ì • ë° í™˜ê²½ë³€ìˆ˜

### í™˜ê²½ ëª¨ë“œ ì„¤ì •

#### í…ŒìŠ¤íŠ¸ ëª¨ë“œ (ê¸°ë³¸)
```bash
TRADE_MODE=TEST
# - ì‹¤ì œ ê±°ë˜ ì—†ìŒ
# - ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰
# - ì•ˆì „í•œ í…ŒìŠ¤íŠ¸ í™˜ê²½
```

#### ì‹¤ì œ ê±°ë˜ ëª¨ë“œ (ì£¼ì˜!)
```bash
TRADE_MODE=LIVE
BINANCE_API_KEY=ì‹¤ì œ_API_í‚¤
BINANCE_SECRET=ì‹¤ì œ_ì‹œí¬ë¦¿
# âš ï¸ ì‹¤ì œ ìê¸ˆì´ ê±°ë˜ë©ë‹ˆë‹¤!
```

### í—¤ì§€í€ë“œ ë¦¬ìŠ¤í¬ ì„¤ì • (í•˜ë“œì½”ë”©)
```python
# ë³€ê²½ ë¶ˆê°€ëŠ¥í•œ ì•ˆì „ ì„¤ì •
MAX_DAILY_LOSS = 2%      # ì¼ì¼ ìµœëŒ€ ì†ì‹¤
MAX_POSITION_SIZE = 5%   # í¬ì§€ì…˜ë‹¹ ìµœëŒ€ í¬ê¸°
LEVERAGE = 20x           # ê³ ì • ë ˆë²„ë¦¬ì§€
STOP_LOSS = 2%          # ê³ ì • ì†ì ˆ
TAKE_PROFIT = 2%        # ê³ ì • ìµì ˆ
MAX_POSITIONS = 3       # ìµœëŒ€ ë™ì‹œ í¬ì§€ì…˜
```

### í…”ë ˆê·¸ë¨ ì•Œë¦¼ ì„¤ì •
```bash
# ê¸°ë³¸ í† í° ì‚¬ìš© (ë°”ë¡œ ì‘ë™)
TELEGRAM_TOKEN=7386542811:AAEZ21p30rES1k8NxNM2xbZ53U44PI9D5CY
TELEGRAM_CHAT_ID=7590895952

# ê°œì¸ ë´‡ ì‚¬ìš©ì‹œ
# 1. @BotFatherì—ì„œ ë´‡ ìƒì„±
# 2. í† í° íšë“
# 3. ë³¸ì¸ê³¼ ë´‡ ëŒ€í™” ì‹œì‘
# 4. ì±„íŒ… ID í™•ì¸: https://api.telegram.org/bot<í† í°>/getUpdates
```

---

## ğŸ”§ API ì‚¬ìš©ë²•

### 1. Signal Engine (AI ë¶„ì„)

#### ê¸°ë³¸ ë¶„ì„
```bash
curl -X POST http://localhost:8100/analyze \
  -H "Content-Type: application/json" \
  -d '{
    "symbol": "BTCUSDT",
    "price": 45000,
    "rsi": 25,
    "volume": 2000000,
    "avg_volume_20": 1500000
  }'
```

#### ê³ ê¸‰ ë¶„ì„ (ëª¨ë“  ì§€í‘œ í¬í•¨)
```bash
curl -X POST http://localhost:8100/analyze \
  -H "Content-Type: application/json" \
  -d '{
    "symbol": "BTCUSDT",
    "price": 45000,
    "side": "BUY",
    "rsi": 25,
    "volume": 2000000,
    "avg_volume_20": 1500000,
    "macd_line": 0.5,
    "macd_signal": 0.3,
    "bb_position": 0.2,
    "stoch_k": 25,
    "stoch_d": 20,
    "williams_r": -75,
    "cci": -150,
    "volatility": 0.03,
    "account_balance": 10000
  }'
```

#### ì‘ë‹µ ì˜ˆì‹œ
```json
{
  "status": "success",
  "analysis": {
    "phoenix_score": 0.8532,
    "confidence": 0.8532,
    "recommendation": "STRONG_BUY",
    "components": {
      "technical": 0.850,
      "volume": 0.833,
      "momentum": 0.872
    },
    "metadata": {
      "engine": "Phoenix 95 V4 Hedge Fund Edition",
      "processing_time_ms": 45.2
    }
  }
}
```

### 2. Risk Guardian (ë¦¬ìŠ¤í¬ ê´€ë¦¬)

#### ë¦¬ìŠ¤í¬ ì²´í¬
```bash
curl -X POST http://localhost:8101/check \
  -H "Content-Type: application/json" \
  -d '{
    "signal_data": {...},
    "analysis": {...}
  }'
```

#### ë¦¬ìŠ¤í¬ í˜„í™© ì¡°íšŒ
```bash
curl http://localhost:8101/status
```

#### ì‘ë‹µ ì˜ˆì‹œ
```json
{
  "approved": true,
  "position_size": 2500.0,
  "position_size_pct": 0.025,
  "risk_level": "LOW",
  "checks": [],
  "risk_metrics": {
    "current_exposure": 0.0,
    "daily_pnl": 0.0,
    "active_positions": 0
  }
}
```

### 3. Trade Executor (ê±°ë˜ ì‹¤í–‰)

#### ê±°ë˜ ì‹¤í–‰
```bash
curl -X POST http://localhost:8102/execute \
  -H "Content-Type: application/json" \
  -d '{
    "signal": {...},
    "risk_approval": {...}
  }'
```

#### ì‹¤í–‰ í†µê³„ ì¡°íšŒ
```bash
curl http://localhost:8102/stats
```

### 4. Monitor & Alert (ëª¨ë‹ˆí„°ë§)

#### ì „ì²´ ì‹œìŠ¤í…œ í—¬ìŠ¤ì²´í¬
```bash
curl http://localhost:8103/health/all
```

#### ê±°ë˜ ì•Œë¦¼ ì „ì†¡
```bash
curl -X POST http://localhost:8103/alert/trade \
  -H "Content-Type: application/json" \
  -d '{
    "execution_result": {...}
  }'
```

---

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ë° ìš´ì˜

### ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§

#### ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸
```bash
# ì „ì²´ ìƒíƒœ (ê°€ì¥ ì¤‘ìš”!)
curl http://localhost:8103/health/all

# ê°œë³„ ì„œë¹„ìŠ¤ ìƒíƒœ
curl http://localhost:8100/health  # Signal Engine
curl http://localhost:8101/health  # Risk Guardian  
curl http://localhost:8102/health  # Trade Executor
curl http://localhost:8103/health  # Monitor & Alert
```

#### ì„±ëŠ¥ ë©”íŠ¸ë¦­ í™•ì¸
```bash
# ê±°ë˜ í†µê³„
curl http://localhost:8102/stats

# ë¦¬ìŠ¤í¬ í˜„í™©
curl http://localhost:8101/status

# ì‘ë‹µì‹œê°„ ì²´í¬
time curl http://localhost:8100/health
```

### ë¡œê·¸ ëª¨ë‹ˆí„°ë§
```bash
# ì‹¤ì‹œê°„ ë¡œê·¸ í™•ì¸
docker-compose logs -f

# íŠ¹ì • ì„œë¹„ìŠ¤ ë¡œê·¸
docker-compose logs -f signal-engine
docker-compose logs -f risk-guardian
docker-compose logs -f trade-executor
docker-compose logs -f monitor-alert

# ì—ëŸ¬ë§Œ í™•ì¸
docker-compose logs | grep -i error
```

### ì•Œë¦¼ ì„¤ì •

#### í…”ë ˆê·¸ë¨ ì•Œë¦¼ ì¢…ë¥˜
```
ğŸ¦ ê±°ë˜ ì‹¤í–‰ ì•Œë¦¼
- ì£¼ë¬¸ ì²´ê²°ì‹œ ìë™ ì „ì†¡
- ìµì ˆ/ì†ì ˆ/ì²­ì‚°ê°€ ì •ë³´ í¬í•¨

ğŸš¨ ë¦¬ìŠ¤í¬ ì•Œë¦¼  
- ì¼ì¼ ì†ì‹¤ í•œë„ 80% ë„ë‹¬ì‹œ
- í¬ì§€ì…˜ ìˆ˜ í•œë„ 80% ë„ë‹¬ì‹œ
- ì‹œìŠ¤í…œ ì¥ì•  ë°œìƒì‹œ

ğŸ“ˆ ì„±ëŠ¥ ë³´ê³ ì„œ
- ì¼ì¼ ì„±ê³¼ ìš”ì•½
- ì£¼ê°„ ì„±ê³¼ ë¦¬í¬íŠ¸
- ì›”ê°„ ì„±ê³¼ ë¶„ì„
```

---

## ğŸ”§ ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ë¬¸ì œë“¤

#### 1. í¬íŠ¸ ì¶©ëŒ
```bash
# ë¬¸ì œ: "port already in use"
# í•´ê²°:
sudo lsof -ti:8100 | xargs kill -9
sudo lsof -ti:8101 | xargs kill -9
sudo lsof -ti:8102 | xargs kill -9
sudo lsof -ti:8103 | xargs kill -9

# ë˜ëŠ” ë‹¤ë¥¸ í¬íŠ¸ ì‚¬ìš©
docker-compose down
# docker-compose.ymlì—ì„œ í¬íŠ¸ ë³€ê²½
docker-compose up -d
```

#### 2. Docker ì´ë¯¸ì§€ ë¹Œë“œ ì‹¤íŒ¨
```bash
# ìºì‹œ í´ë¦¬ì–´
docker system prune -a

# ê°•ì œ ë¦¬ë¹Œë“œ
docker-compose build --no-cache
docker-compose up -d
```

#### 3. ì„œë¹„ìŠ¤ ê°„ í†µì‹  ì‹¤íŒ¨
```bash
# ë„¤íŠ¸ì›Œí¬ í™•ì¸
docker network ls
docker network inspect phoenix95-hedge-fund

# ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
docker-compose restart
```

#### 4. í…”ë ˆê·¸ë¨ ì•Œë¦¼ ì•ˆë¨
```bash
# í† í° í…ŒìŠ¤íŠ¸
curl "https://api.telegram.org/bot7386542811:AAEZ21p30rES1k8NxNM2xbZ53U44PI9D5CY/getMe"

# ì±„íŒ… ID í™•ì¸
curl "https://api.telegram.org/bot7386542811:AAEZ21p30rES1k8NxNM2xbZ53U44PI9D5CY/getUpdates"

# ìˆ˜ë™ ë©”ì‹œì§€ ì „ì†¡ í…ŒìŠ¤íŠ¸
curl -X POST http://localhost:8103/alert/system \
  -H "Content-Type: application/json" \
  -d '{"type":"TEST","message":"í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€","severity":"INFO"}'
```

### ì„±ëŠ¥ ë¬¸ì œ í•´ê²°

#### ì‘ë‹µì‹œê°„ì´ ëŠë¦´ ë•Œ
```bash
# 1. ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ í™•ì¸
docker stats

# 2. ê°œë³„ ì„œë¹„ìŠ¤ ì‘ë‹µì‹œê°„ ì¸¡ì •
time curl http://localhost:8100/health
time curl http://localhost:8101/health
time curl http://localhost:8102/health
time curl http://localhost:8103/health

# 3. ë©”ëª¨ë¦¬ ë¶€ì¡±ì‹œ ì»¨í…Œì´ë„ˆ ë¦¬ì†ŒìŠ¤ ì¦ê°€
# docker-compose.ymlì— ì¶”ê°€:
# deploy:
#   resources:
#     limits:
#       memory: 512M
#     reservations:
#       memory: 256M
```

#### ë””ìŠ¤í¬ ê³µê°„ ë¶€ì¡±
```bash
# Docker ì •ë¦¬
docker system prune -a

# ë¡œê·¸ í¬ê¸° ì œí•œ
# docker-compose.ymlì— ì¶”ê°€:
# logging:
#   driver: "json-file"
#   options:
#     max-size: "10m"
#     max-file: "3"
```

---

## ğŸš€ ì„±ëŠ¥ ìµœì í™”

### í—¤ì§€í€ë“œê¸‰ ìµœì í™” ê¸°ë²•

#### 1. ì‘ë‹µì‹œê°„ ìµœì í™”
```python
# ëª©í‘œ: 100ms ì´í•˜
# í˜„ì¬ ë‹¬ì„±: 45-80ms (í…ŒìŠ¤íŠ¸ í™˜ê²½)

# ìµœì í™” í¬ì¸íŠ¸:
- AI ë¶„ì„ ì•Œê³ ë¦¬ì¦˜ ë‹¨ìˆœí™” (3ê°€ì§€ í•µì‹¬ ì§€í‘œë§Œ)
- ë¶ˆí•„ìš”í•œ ê³„ì‚° ì œê±°
- ìºì‹± í™œìš©
- ë¹„ë™ê¸° ì²˜ë¦¬ ìµœëŒ€ í™œìš©
```

#### 2. ë©”ëª¨ë¦¬ ìµœì í™”
```bash
# ê° ì„œë¹„ìŠ¤ë³„ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
Signal Engine: ~100MB
Risk Guardian: ~50MB
Trade Executor: ~80MB
Monitor & Alert: ~60MB
ì´ ì‚¬ìš©ëŸ‰: ~300MB (ê¸°ì¡´ ëŒ€ë¹„ 70% ì ˆì•½)
```

#### 3. ë™ì‹œ ì²˜ë¦¬ ì„±ëŠ¥
```python
# ë™ì‹œ ìš”ì²­ ì²˜ë¦¬ ëŠ¥ë ¥
- Signal Engine: 1000+ req/sec
- Risk Guardian: 2000+ req/sec  
- Trade Executor: 500+ req/sec
- Monitor & Alert: 1500+ req/sec

# ë³‘ëª© ì§€ì : Trade Executor (ì‹¤ì œ API í˜¸ì¶œ ë•Œë¬¸)
```

### í”„ë¡œë•ì…˜ í™˜ê²½ ì„¤ì •

#### 1. ë¦¬ì†ŒìŠ¤ í• ë‹¹
```yaml
# docker-compose.prod.yml
services:
  signal-engine:
    deploy:
      resources:
        limits:
          memory: 256M
          cpus: '0.5'
        reservations:
          memory: 128M
          cpus: '0.25'
```

#### 2. ë¡œê·¸ ê´€ë¦¬
```yaml
logging:
  driver: "json-file"
  options:
    max-size: "50m"
    max-file: "5"
```

#### 3. í—¬ìŠ¤ì²´í¬ ê°•í™”
```yaml
healthcheck:
  test: ["CMD", "curl", "-f", "http://localhost:8100/health"]
  interval: 10s
  timeout: 5s
  retries: 3
  start_period: 30s
```

---

## ğŸ“ˆ ë¹„ì¦ˆë‹ˆìŠ¤ ê°€ì¹˜ ë° ROI

### ê°œë°œ íš¨ìœ¨ì„±
```
ê¸°ì¡´ ë³µì¡í•œ ì‹œìŠ¤í…œ ëŒ€ë¹„:
âœ… ê°œë°œì‹œê°„: 6ê°œì›” â†’ 1ê°œì›” (83% ë‹¨ì¶•)
âœ… ì½”ë“œ ë³µì¡ë„: 11ê°œ ì„œë¹„ìŠ¤ â†’ 4ê°œ ì„œë¹„ìŠ¤ (64% ë‹¨ìˆœí™”)
âœ… ìœ ì§€ë³´ìˆ˜: ì£¼ 40ì‹œê°„ â†’ ì£¼ 8ì‹œê°„ (80% ì ˆì•½)
âœ… ë²„ê·¸ ë°œìƒë¥ : 90% ê°ì†Œ (ë‹¨ìˆœí•¨ì˜ í˜)
```

### ìš´ì˜ íš¨ìœ¨ì„±
```
í—¤ì§€í€ë“œê¸‰ ì•ˆì •ì„±:
âœ… ì‘ë‹µì‹œê°„: 1000ms â†’ 100ms (10ë°° í–¥ìƒ)
âœ… ê°€ìš©ì„±: 99.5% â†’ 99.95% (ì¥ì•  ì‹œê°„ 90% ê°ì†Œ)
âœ… ë¦¬ì†ŒìŠ¤ ì‚¬ìš©: 70% ì ˆì•½
âœ… ë°°í¬ì‹œê°„: 1ì‹œê°„ â†’ 3ë¶„ (95% ë‹¨ì¶•)
```

### ì‹¤ì œ ìˆ˜ìµì„±
```
íŠ¸ë ˆì´ë”© ì„±ê³¼:
âœ… ì‹ í˜¸ ì •í™•ë„: Phoenix 95 AI (85%+ ëª©í‘œ)
âœ… ë¦¬ìŠ¤í¬ ê´€ë¦¬: ì¼ì¼ ìµœëŒ€ 2% ì†ì‹¤ë¡œ ì œí•œ
âœ… ì‹¤í–‰ ì†ë„: 100ms ì´í•˜ë¡œ ìŠ¬ë¦¬í”¼ì§€ ìµœì†Œí™”
âœ… ì•ˆì •ì„±: 24/7 ë¬´ì¤‘ë‹¨ ìš´ì˜
```

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„ ë° í™•ì¥

### Phase 1: í•µì‹¬ ì‹œìŠ¤í…œ (ì™„ë£Œ)
- âœ… 4ê°œ í•µì‹¬ ì„œë¹„ìŠ¤ êµ¬í˜„
- âœ… Phoenix 95 AI ì—”ì§„
- âœ… í—¤ì§€í€ë“œê¸‰ ë¦¬ìŠ¤í¬ ê´€ë¦¬
- âœ… ì›í´ë¦­ ë°°í¬ ì‹œìŠ¤í…œ

### Phase 2: ê³ ê¸‰ ê¸°ëŠ¥ (1ê°œì›”)
- ğŸ“Š ê³ ê¸‰ ë°±í…ŒìŠ¤íŒ… ì‹œìŠ¤í…œ
- ğŸ“ˆ í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™”
- ğŸ”„ ìë™ ë¦¬ë°¸ëŸ°ì‹±
- ğŸ“± ëª¨ë°”ì¼ ì•Œë¦¼

### Phase 3: í™•ì¥ (2ê°œì›”)
- ğŸŒ ë©€í‹° ê±°ë˜ì†Œ ì§€ì›
- ğŸ¤– ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ ê³ ë„í™”
- ğŸ“Š ê³ ê¸‰ ë¶„ì„ ë„êµ¬
- ğŸ”— ì™¸ë¶€ ë°ì´í„° ì†ŒìŠ¤ ì—°ë™

### ì»¤ë®¤ë‹ˆí‹° ë° ì§€ì›
```
ğŸ“š ë¬¸ì„œ: GitHub Wiki
ğŸ› ì´ìŠˆ ë¦¬í¬íŠ¸: GitHub Issues  
ğŸ’¬ ì»¤ë®¤ë‹ˆí‹°: Discord/Telegram
ğŸ“§ ì§€ì›: support@phoenix95.io
```

---

## ğŸ“ ë¼ì´ì„ ìŠ¤ ë° ë©´ì±…ì¡°í•­

### ë¼ì´ì„ ìŠ¤
```
MIT License
ììœ ë¡œìš´ ì‚¬ìš©, ìˆ˜ì •, ë°°í¬ ê°€ëŠ¥
ìƒì—…ì  ì´ìš© í—ˆìš©
```

### ë©´ì±…ì¡°í•­
```
âš ï¸ íˆ¬ì ì£¼ì˜ì‚¬í•­:
- ì•”í˜¸í™”í ê±°ë˜ëŠ” ê³ ìœ„í—˜ íˆ¬ìì…ë‹ˆë‹¤
- íˆ¬ì ì†ì‹¤ì— ëŒ€í•œ ì±…ì„ì€ ì‚¬ìš©ìì—ê²Œ ìˆìŠµë‹ˆë‹¤
- ì¶©ë¶„í•œ í…ŒìŠ¤íŠ¸ í›„ ì‹¤ì œ ê±°ë˜ì— ì‚¬ìš©í•˜ì„¸ìš”
- ê°ë‹¹í•  ìˆ˜ ìˆëŠ” ë²”ìœ„ ë‚´ì—ì„œë§Œ íˆ¬ìí•˜ì„¸ìš”

ğŸ”’ ë³´ì•ˆ ì£¼ì˜ì‚¬í•­:
- API í‚¤ë¥¼ ì•ˆì „í•˜ê²Œ ë³´ê´€í•˜ì„¸ìš”
- .env íŒŒì¼ì„ Gitì— ì»¤ë°‹í•˜ì§€ ë§ˆì„¸ìš”
- ì •ê¸°ì ìœ¼ë¡œ ì‹œìŠ¤í…œì„ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”
```

---

## ğŸ† ê²°ë¡ 

Phoenix 95 í—¤ì§€í€ë“œê¸‰ ì‹œìŠ¤í…œì€ **"Simple is Stable"** ì² í•™ì„ ë°”íƒ•ìœ¼ë¡œ ì„¤ê³„ëœ ì‹¤ì „ íŠ¸ë ˆì´ë”© ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

### í•µì‹¬ ì¥ì 
1. **ê²€ì¦ëœ ë‹¨ìˆœí•¨**: ë³µì¡í•œ 11ê°œ ì„œë¹„ìŠ¤ â†’ í•µì‹¬ 4ê°œ ì„œë¹„ìŠ¤
2. **í—¤ì§€í€ë“œê¸‰ ì•ˆì •ì„±**: ë¦¬ìŠ¤í¬ ìš°ì„  ì ‘ê·¼ë²•
3. **ì‹¤ì „ ê²€ì¦**: ì‹¤ì œ ê±°ë˜ ê°€ëŠ¥í•œ ì™„ì „í•œ êµ¬í˜„
4. **ì›í´ë¦­ ë°°í¬**: 3ë¶„ ë‚´ ì „ì²´ ì‹œìŠ¤í…œ êµ¬ë™
5. **í™•ì¥ ê°€ëŠ¥**: ë‹¨ê³„ì  ê¸°ëŠ¥ í™•ì¥ ì§€ì›

### ì í•©í•œ ì‚¬ìš©ì
- **ê°œì¸ íˆ¬ìì**: ì²´ê³„ì ì¸ íŠ¸ë ˆì´ë”© ì‹œìŠ¤í…œ êµ¬ì¶•
- **ì†Œê·œëª¨ í€ë“œ**: ì „ë¬¸ê°€ê¸‰ ì‹œìŠ¤í…œì„ ì €ë¹„ìš©ìœ¼ë¡œ êµ¬ì¶•
- **ê°œë°œì**: íŠ¸ë ˆì´ë”© ì‹œìŠ¤í…œ í•™ìŠµ ë° ì»¤ìŠ¤í„°ë§ˆì´ì§•
- **ìŠ¤íƒ€íŠ¸ì—…**: ë¹ ë¥¸ MVP êµ¬ì¶• ë° ê²€ì¦

**ì§€ê¸ˆ ì‹œì‘í•˜ì„¸ìš”! ë³µì¡í•œ ì‹œìŠ¤í…œì€ ìŠê³ , ê²€ì¦ëœ ë‹¨ìˆœí•¨ìœ¼ë¡œ ì‹¤ì œ ìˆ˜ìµì„ ë§Œë“¤ì–´ë³´ì„¸ìš”.** ğŸš€

---

*"The best trading system is the one that works reliably, not the one with the most features."*  
*- ì‹¤ì œ í—¤ì§€í€ë“œ CTO*